<!doctype html><html lang=zh-cn><head prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#"><meta charset=utf-8><meta name=generator content="Hugo 0.91.2"><meta name=theme-color content="#16171d"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=format-detection content="telephone=no, date=no, address=no, email=no"><meta http-equiv=cache-control content="no-transform"><meta http-equiv=cache-control content="no-siteapp"><title>50.RESTfulæ¶æ„å’ŒDRFè¿›é˜¶ | Hanxin</title><link rel=stylesheet href=/css/meme.min.88c90dc75021618344ec926f4ed6ac307f30ba48911294816b16370a41e5f137.css><script src=/js/meme.min.f460a174bb100a60a7e275913695161f1e09aab1378fe99cfd30cde14da70888.js></script>
<link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400;0,500;0,700;1,400;1,700&family=Noto+Serif+SC:wght@400;500;700&family=Source+Code+Pro:ital,wght@0,400;0,700;1,400;1,700&family=Satisfy&family=Klee+One:wght@400;600&family=Great+Vibes&display=swap" media=print onload="this.media='all'"><noscript><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400;0,500;0,700;1,400;1,700&family=Noto+Serif+SC:wght@400;500;700&family=Source+Code+Pro:ital,wght@0,400;0,700;1,400;1,700&family=Satisfy&family=Klee+One:wght@400;600&family=Great+Vibes&display=swap"></noscript><meta name=author content="éª†æ˜Š"><meta name=description content="RESTfulæ¶æ„å’ŒDRFè¿›é˜¶ é™¤äº†ä¸Šä¸€èŠ‚è®²åˆ°çš„æ–¹æ³•ï¼Œä½¿ç”¨DRFåˆ›å»ºRESTé£æ ¼çš„æ•°æ®â€¦â€¦"><link rel="shortcut icon" href=/favicon.ico type=image/x-icon><link rel=mask-icon href=/icons/safari-pinned-tab.svg color=#2a6df4><link rel=apple-touch-icon sizes=180x180 href=/icons/apple-touch-icon.png><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-title content="Hanxin"><meta name=apple-mobile-web-app-status-bar-style content="black"><meta name=mobile-web-app-capable content="yes"><meta name=application-name content="Hanxin"><meta name=msapplication-starturl content="../../"><meta name=msapplication-TileColor content="#fff"><meta name=msapplication-TileImage content="../../icons/mstile-150x150.png"><link rel=manifest href=/manifest.json><link rel=canonical href=/python/50.restful%E6%9E%B6%E6%9E%84%E5%92%8Cdrf%E8%BF%9B%E9%98%B6/><script type=application/ld+json>{"@context":"https://schema.org","@type":"WebPage","datePublished":"2021-08-23T17:34:34+08:00","dateModified":"2022-01-16T09:24:35+00:00","url":"/python/50.restful%E6%9E%B6%E6%9E%84%E5%92%8Cdrf%E8%BF%9B%E9%98%B6/","name":"50.RESTfulæ¶æ„å’ŒDRFè¿›é˜¶","description":"RESTfulæ¶æ„å’ŒDRFè¿›é˜¶ é™¤äº†ä¸Šä¸€èŠ‚è®²åˆ°çš„æ–¹æ³•ï¼Œä½¿ç”¨DRFåˆ›å»ºRESTé£æ ¼çš„æ•°æ®â€¦â€¦","image":"/icons/apple-touch-icon.png","license":"æœ¬æ–‡é‡‡ç”¨[ã€ŒCC BY-NC-SA 4.0ã€](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)åè®®ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚","publisher":{"@type":"Organization","name":"Hanxin","logo":{"@type":"ImageObject","url":"/icons/apple-touch-icon.png"},"url":"/"},"mainEntityOfPage":{"@type":"WebSite","@id":"/"}}</script><meta name=twitter:card content="summary"><meta property="og:title" content="50.RESTfulæ¶æ„å’ŒDRFè¿›é˜¶"><meta property="og:description" content="RESTfulæ¶æ„å’ŒDRFè¿›é˜¶ é™¤äº†ä¸Šä¸€èŠ‚è®²åˆ°çš„æ–¹æ³•ï¼Œä½¿ç”¨DRFåˆ›å»ºRESTé£æ ¼çš„æ•°æ®â€¦â€¦"><meta property="og:url" content="/python/50.restful%E6%9E%B6%E6%9E%84%E5%92%8Cdrf%E8%BF%9B%E9%98%B6/"><meta property="og:site_name" content="Hanxin"><meta property="og:locale" content="zh"><meta property="og:image" content="/icons/apple-touch-icon.png"><meta property="og:type" content="website"></head><body><div class=container><header class=header><div class=header-wrapper><div class="header-inner single"><div class=site-brand><a href=/ class=brand>Hanxin</a></div><nav class=nav><ul class=menu id=menu><li class=menu-item><a href=/life/><span class=menu-item-name>ç”Ÿæ´»</span></a></li><li class=menu-item><a href=/tech/><span class=menu-item-name>æŠ€æœ¯</span></a></li><li class=menu-item><a href=/tags/><span class=menu-item-name>æ ‡ç­¾</span></a></li><li class=menu-item><a href=/about/><span class=menu-item-name>å…³äº</span></a></li><li class=menu-item><a href=/blogroll/><span class=menu-item-name>å‹é“¾</span></a></li><li class=menu-item><a href=/python/><span class=menu-item-name>Python-100å¤©</span></a></li><li class=menu-item><a id=theme-switcher href=#><span class="icon theme-icon-light">ğŸŒ</span><span class="icon theme-icon-dark">ğŸŒ™</span></a></li></ul></nav></div></div><input type=checkbox id=nav-toggle aria-hidden=true>
<label for=nav-toggle class=nav-toggle></label>
<label for=nav-toggle class=nav-curtain></label></header><main class="main single" id=main><div class=main-inner><article class="content post h-entry" data-align=justify data-type=python data-toc-num=true><h1 class="post-title p-name">50.RESTfulæ¶æ„å’ŒDRFè¿›é˜¶</h1><div class=post-meta><time datetime=2021-08-23T17:34:34+08:00 class="post-meta-item published dt-published"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon post-meta-icon"><path d="M148 288h-40c-6.6.0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h40c6.6.0 12 5.4 12 12v40c0 6.6-5.4 12-12 12zm108-12v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm-96 96v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm-96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm192 0v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm96-260v352c0 26.5-21.5 48-48 48H48c-26.5.0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h48V12c0-6.6 5.4-12 12-12h40c6.6.0 12 5.4 12 12v52h128V12c0-6.6 5.4-12 12-12h40c6.6.0 12 5.4 12 12v52h48c26.5.0 48 21.5 48 48zm-48 346V160H48v298c0 3.3 2.7 6 6 6h340c3.3.0 6-2.7 6-6z"/></svg>&nbsp;2021.8.23</time>
<time datetime=2022-01-16T09:24:35+00:00 class="post-meta-item modified dt-updated"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon post-meta-icon"><path d="M4e2 64h-48V12c0-6.627-5.373-12-12-12h-40c-6.627.0-12 5.373-12 12v52H160V12c0-6.627-5.373-12-12-12h-40c-6.627.0-12 5.373-12 12v52H48C21.49 64 0 85.49.0 112v352c0 26.51 21.49 48 48 48h352c26.51.0 48-21.49 48-48V112c0-26.51-21.49-48-48-48zm-6 4e2H54a6 6 0 01-6-6V160h352v298a6 6 0 01-6 6zm-52.849-200.65L198.842 404.519c-4.705 4.667-12.303 4.637-16.971-.068l-75.091-75.699c-4.667-4.705-4.637-12.303.068-16.971l22.719-22.536c4.705-4.667 12.303-4.637 16.97.069l44.104 44.461 111.072-110.181c4.705-4.667 12.303-4.637 16.971.068l22.536 22.718c4.667 4.705 4.636 12.303-.069 16.97z"/></svg>&nbsp;2022.1.16</time>
<span class="post-meta-item wordcount"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon post-meta-icon"><path d="M497.9 142.1l-46.1 46.1c-4.7 4.7-12.3 4.7-17 0l-111-111c-4.7-4.7-4.7-12.3.0-17l46.1-46.1c18.7-18.7 49.1-18.7 67.9.0l60.1 60.1c18.8 18.7 18.8 49.1.0 67.9zM284.2 99.8 21.6 362.4.4 483.9c-2.9 16.4 11.4 30.6 27.8 27.8l121.5-21.3 262.6-262.6c4.7-4.7 4.7-12.3.0-17l-111-111c-4.8-4.7-12.4-4.7-17.1.0zM124.1 339.9c-5.5-5.5-5.5-14.3.0-19.8l154-154c5.5-5.5 14.3-5.5 19.8.0s5.5 14.3.0 19.8l-154 154c-5.5 5.5-14.3 5.5-19.8.0zM88 424h48v36.3l-64.5 11.3-31.1-31.1L51.7 376H88v48z"/></svg>&nbsp;2589</span>
<span class="post-meta-item reading-time"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon post-meta-icon"><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm0 448c-110.5.0-2e2-89.5-2e2-2e2S145.5 56 256 56s2e2 89.5 2e2 2e2-89.5 2e2-2e2 2e2zm61.8-104.4-84.9-61.7c-3.1-2.3-4.9-5.9-4.9-9.7V116c0-6.6 5.4-12 12-12h32c6.6.0 12 5.4 12 12v141.7l66.8 48.6c5.4 3.9 6.5 11.4 2.6 16.8L334.6 349c-3.9 5.3-11.4 6.5-16.8 2.6z"/></svg>&nbsp;6&nbsp;åˆ†é’Ÿ</span></div><div class="post-body e-content"><h2 id=restfulæ¶æ„å’Œdrfè¿›é˜¶><a href=#restfulæ¶æ„å’Œdrfè¿›é˜¶ class=anchor-link>#</a>RESTfulæ¶æ„å’ŒDRFè¿›é˜¶</h2><p>é™¤äº†ä¸Šä¸€èŠ‚è®²åˆ°çš„æ–¹æ³•ï¼Œä½¿ç”¨DRFåˆ›å»ºRESTé£æ ¼çš„æ•°æ®æ¥å£ä¹Ÿå¯ä»¥é€šè¿‡CBVï¼ˆåŸºäºç±»çš„è§†å›¾ï¼‰çš„æ–¹å¼ã€‚ä½¿ç”¨CBVåˆ›å»ºæ•°æ®æ¥å£çš„ç‰¹ç‚¹æ˜¯ä»£ç ç®€å•ï¼Œå¼€å‘æ•ˆç‡é«˜ï¼Œä½†æ˜¯æ²¡æœ‰FBVï¼ˆåŸºäºå‡½æ•°çš„è§†å›¾ï¼‰çµæ´»ï¼Œå› ä¸ºä½¿ç”¨FBVçš„æ–¹å¼ï¼Œæ•°æ®æ¥å£å¯¹åº”çš„è§†å›¾å‡½æ•°æ‰§è¡Œä»€ä¹ˆæ ·çš„ä»£ç ä»¥åŠè¿”å›ä»€ä¹ˆçš„æ•°æ®æ˜¯é«˜åº¦å¯å®šåˆ¶çš„ã€‚ä¸‹é¢æˆ‘ä»¬ä»¥å®šåˆ¶å­¦ç§‘çš„æ•°æ®æ¥å£ä¸ºä¾‹ï¼Œè®²è§£é€šè¿‡CBVæ–¹å¼å®šåˆ¶æ•°æ®æ¥å£çš„å…·ä½“åšæ³•ã€‚</p><h3 id=ä½¿ç”¨cbv><a href=#ä½¿ç”¨cbv class=anchor-link>#</a>ä½¿ç”¨CBV</h3><h4 id=ç»§æ‰¿apiviewçš„å­ç±»><a href=#ç»§æ‰¿apiviewçš„å­ç±» class=anchor-link>#</a>ç»§æ‰¿APIViewçš„å­ç±»</h4><p>ä¿®æ”¹ä¹‹å‰é¡¹ç›®ä¸­çš„<code>polls/views.py</code>ï¼Œå»æ‰<code>show_subjects</code>è§†å›¾å‡½æ•°ï¼Œæ·»åŠ ä¸€ä¸ªåä¸º<code>SubjectView</code>çš„ç±»ï¼Œè¯¥ç±»ç»§æ‰¿è‡ª<code>ListAPIView</code>ï¼Œ<code>ListAPIView</code>èƒ½æ¥æ”¶GETè¯·æ±‚ï¼Œå®ƒå°è£…äº†è·å–æ•°æ®åˆ—è¡¨å¹¶è¿”å›JSONæ•°æ®çš„<code>get</code>æ–¹æ³•ã€‚<code>ListAPIView</code>æ˜¯<code>APIView</code> çš„å­ç±»ï¼Œ<code>APIView</code>è¿˜æœ‰å¾ˆå¤šçš„å­ç±»ï¼Œä¾‹å¦‚<code>CreateAPIView</code>å¯ä»¥æ”¯æŒPOSTè¯·æ±‚ï¼Œ<code>UpdateAPIView</code>å¯ä»¥æ”¯æŒPUTå’ŒPATCHè¯·æ±‚ï¼Œ<code>DestoryAPIView</code>å¯ä»¥æ”¯æŒDELETEè¯·æ±‚ã€‚<code>SubjectView</code> çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=kn>from</span> <span class=nn>rest_framework.generics</span> <span class=kn>import</span> <span class=n>ListAPIView</span>


<span class=k>class</span> <span class=nc>SubjectView</span><span class=p>(</span><span class=n>ListAPIView</span><span class=p>):</span>
    <span class=c1># é€šè¿‡querysetæŒ‡å®šå¦‚ä½•è·å–å­¦ç§‘æ•°æ®</span>
    <span class=n>queryset</span> <span class=o>=</span> <span class=n>Subject</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>all</span><span class=p>()</span>
    <span class=c1># é€šè¿‡serializer_classæŒ‡å®šå¦‚ä½•åºåˆ—åŒ–å­¦ç§‘æ•°æ®</span>
    <span class=n>serializer_class</span> <span class=o>=</span> <span class=n>SubjectSerializer</span>
</code></pre></td></tr></table></div></div></div><p>åˆšæ‰è¯´è¿‡ï¼Œç”±äº<code>SubjectView</code>çš„çˆ¶ç±»<code>ListAPIView</code>å·²ç»å®ç°äº†<code>get</code>æ–¹æ³•æ¥å¤„ç†è·å–å­¦ç§‘åˆ—è¡¨çš„GETè¯·æ±‚ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦å£°æ˜å¦‚ä½•è·å–å­¦ç§‘æ•°æ®ä»¥åŠå¦‚ä½•åºåˆ—åŒ–å­¦ç§‘æ•°æ®ï¼Œå‰è€…ç”¨<code>queryset</code>å±æ€§æŒ‡å®šï¼Œåè€…ç”¨<code>serializer_class</code>å±æ€§æŒ‡å®šã€‚è¦ä½¿ç”¨ä¸Šé¢çš„<code>SubjectView</code>ï¼Œéœ€è¦ä¿®æ”¹<code>urls.py</code>æ–‡ä»¶ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=n>urlpatterns</span> <span class=o>=</span> <span class=p>[</span>
    <span class=n>path</span><span class=p>(</span><span class=s1>&#39;api/subjects/&#39;</span><span class=p>,</span> <span class=n>SubjectView</span><span class=o>.</span><span class=n>as_view</span><span class=p>()),</span>   
<span class=p>]</span>
</code></pre></td></tr></table></div></div></div><p>å¾ˆæ˜¾ç„¶ï¼Œä¸Šé¢çš„åšæ³•è¾ƒä¹‹ä¹‹å‰è®²åˆ°çš„FBVè¦ç®€å•å¾ˆå¤šã€‚</p><h4 id=ç»§æ‰¿modelviewset><a href=#ç»§æ‰¿modelviewset class=anchor-link>#</a>ç»§æ‰¿ModelViewSet</h4><p>å¦‚æœå­¦ç§‘å¯¹åº”çš„æ•°æ®æ¥å£éœ€è¦æ”¯æŒGETã€POSTã€PUTã€PATCHã€DELETEè¯·æ±‚æ¥æ”¯æŒå¯¹å­¦ç§‘èµ„æºçš„è·å–ã€æ–°å¢ã€æ›´æ–°ã€åˆ é™¤æ“ä½œï¼Œæ›´ä¸ºç®€å•çš„åšæ³•æ˜¯ç»§æ‰¿<code>ModelViewSet</code>æ¥ç¼–å†™å­¦ç§‘è§†å›¾ç±»ã€‚å†æ¬¡ä¿®æ”¹<code>polls/views.py</code>æ–‡ä»¶ï¼Œå»æ‰<code>SubjectView</code>ç±»ï¼Œæ·»åŠ ä¸€ä¸ªåä¸º<code>SubjectViewSet</code>çš„ç±»ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=kn>from</span> <span class=nn>rest_framework.viewsets</span> <span class=kn>import</span> <span class=n>ModelViewSet</span>


<span class=k>class</span> <span class=nc>SubjectViewSet</span><span class=p>(</span><span class=n>ModelViewSet</span><span class=p>):</span>
    <span class=n>queryset</span> <span class=o>=</span> <span class=n>Subject</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>all</span><span class=p>()</span>
    <span class=n>serializer_class</span> <span class=o>=</span> <span class=n>SubjectSerializer</span>
</code></pre></td></tr></table></div></div></div><p>é€šè¿‡æŸ¥çœ‹<code>ModelViewSet</code>ç±»çš„æºä»£ç å¯ä»¥å‘ç°ï¼Œè¯¥ç±»å…±æœ‰6ä¸ªçˆ¶ç±»ï¼Œå…¶ä¸­å‰5ä¸ªçˆ¶ç±»åˆ†åˆ«å®ç°å¯¹POSTï¼ˆæ–°å¢å­¦ç§‘ï¼‰ã€GETï¼ˆè·å–æŒ‡å®šå­¦ç§‘ï¼‰ã€PUT/PATCHï¼ˆæ›´æ–°å­¦ç§‘ï¼‰ã€DELETEï¼ˆåˆ é™¤å­¦ç§‘ï¼‰å’ŒGETï¼ˆè·å–å­¦ç§‘åˆ—è¡¨ï¼‰æ“ä½œçš„æ”¯æŒï¼Œå¯¹åº”çš„æ–¹æ³•åˆ†åˆ«æ˜¯<code>create</code>ã€<code>retrieve</code>ã€<code>update</code>ã€<code>destroy</code>å’Œ<code>list</code>ã€‚ç”±äº<code>ModelViewSet</code>çš„çˆ¶ç±»ä¸­å·²ç»å®ç°äº†è¿™äº›æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬å‡ ä¹æ²¡æœ‰ç¼–å†™ä»»ä½•ä»£ç å°±å®Œæˆäº†å­¦ç§‘æ•°æ®å…¨å¥—æ¥å£çš„å¼€å‘ï¼Œæˆ‘ä»¬è¦åšçš„ä»…ä»…æ˜¯æŒ‡å‡ºå¦‚ä½•è·å–åˆ°æ•°æ®ï¼ˆé€šè¿‡<code>queryset</code>å±æ€§æŒ‡å®šï¼‰ä»¥åŠå¦‚ä½•åºåˆ—åŒ–æ•°æ®ï¼ˆé€šè¿‡<code>serializer_class</code>å±æ€§æŒ‡å®šï¼‰ï¼Œè¿™ä¸€ç‚¹è·Ÿä¸Šé¢ç»§æ‰¿<code>APIView</code>çš„å­ç±»åšæ³•æ˜¯ä¸€è‡´çš„ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=k>class</span> <span class=nc>ModelViewSet</span><span class=p>(</span><span class=n>mixins</span><span class=o>.</span><span class=n>CreateModelMixin</span><span class=p>,</span>
                   <span class=n>mixins</span><span class=o>.</span><span class=n>RetrieveModelMixin</span><span class=p>,</span>
                   <span class=n>mixins</span><span class=o>.</span><span class=n>UpdateModelMixin</span><span class=p>,</span>
                   <span class=n>mixins</span><span class=o>.</span><span class=n>DestroyModelMixin</span><span class=p>,</span>
                   <span class=n>mixins</span><span class=o>.</span><span class=n>ListModelMixin</span><span class=p>,</span>
                   <span class=n>GenericViewSet</span><span class=p>):</span>
    <span class=s2>&#34;&#34;&#34;
</span><span class=s2>    A viewset that provides default `create()`, `retrieve()`, `update()`,
</span><span class=s2>    `partial_update()`, `destroy()` and `list()` actions.
</span><span class=s2>    &#34;&#34;&#34;</span>
    <span class=k>pass</span>
</code></pre></td></tr></table></div></div></div><p>è¦ä½¿ç”¨ä¸Šé¢çš„<code>SubjectViewSet</code>ï¼Œéœ€è¦åœ¨<code>urls.py</code>æ–‡ä»¶ä¸­è¿›è¡ŒURLæ˜ å°„ã€‚ç”±äº<code>ModelViewSet</code>ç›¸å½“äºæ˜¯å¤šä¸ªè§†å›¾å‡½æ•°çš„æ±‡æ€»ï¼Œæ‰€ä»¥ä¸åŒäºä¹‹å‰æ˜ å°„URLçš„æ–¹å¼ï¼Œæˆ‘ä»¬éœ€è¦å…ˆåˆ›å»ºä¸€ä¸ªè·¯ç”±å™¨å¹¶é€šè¿‡å®ƒæ³¨å†Œ<code>SubjectViewSet</code>ï¼Œç„¶åå°†æ³¨å†ŒæˆåŠŸåç”Ÿæˆçš„URLä¸€å¹¶æ·»åŠ åˆ°<code>urlspattern</code>åˆ—è¡¨ä¸­ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=kn>from</span> <span class=nn>rest_framework.routers</span> <span class=kn>import</span> <span class=n>DefaultRouter</span>

<span class=n>router</span> <span class=o>=</span> <span class=n>DefaultRouter</span><span class=p>()</span>
<span class=n>router</span><span class=o>.</span><span class=n>register</span><span class=p>(</span><span class=s1>&#39;api/subjects&#39;</span><span class=p>,</span> <span class=n>SubjectViewSet</span><span class=p>)</span>
<span class=n>urlpatterns</span> <span class=o>+=</span> <span class=n>router</span><span class=o>.</span><span class=n>urls</span>
</code></pre></td></tr></table></div></div></div><p>é™¤äº†<code>ModelViewSet</code>ç±»å¤–ï¼ŒDRFè¿˜æä¾›äº†ä¸€ä¸ªåä¸º<code>ReadOnlyModelViewSet</code> çš„ç±»ï¼Œä»åå­—ä¸Šå°±å¯ä»¥çœ‹å‡ºï¼Œè¯¥ç±»æ˜¯åªè¯»è§†å›¾çš„é›†åˆï¼Œä¹Ÿå°±æ„å‘³ç€ï¼Œç»§æ‰¿è¯¥ç±»å®šåˆ¶çš„æ•°æ®æ¥å£åªèƒ½æ”¯æŒGETè¯·æ±‚ï¼Œä¹Ÿå°±æ˜¯è·å–å•ä¸ªèµ„æºå’Œèµ„æºåˆ—è¡¨çš„è¯·æ±‚ã€‚</p><h3 id=æ•°æ®åˆ†é¡µ><a href=#æ•°æ®åˆ†é¡µ class=anchor-link>#</a>æ•°æ®åˆ†é¡µ</h3><p>åœ¨ä½¿ç”¨GETè¯·æ±‚è·å–èµ„æºåˆ—è¡¨æ—¶ï¼Œæˆ‘ä»¬é€šå¸¸ä¸ä¼šä¸€æ¬¡æ€§çš„åŠ è½½æ‰€æœ‰çš„æ•°æ®ï¼Œé™¤éæ•°æ®é‡çœŸçš„å¾ˆå°ã€‚å¤§å¤šæ•°è·å–èµ„æºåˆ—è¡¨çš„æ“ä½œéƒ½æ”¯æŒæ•°æ®åˆ†é¡µå±•ç¤ºï¼Œä¹Ÿå°±è¯´æˆ‘ä»¬å¯ä»¥é€šè¿‡æŒ‡å®šé¡µç ï¼ˆæˆ–ç±»ä¼¼äºé¡µç çš„æ ‡è¯†ï¼‰å’Œé¡µé¢å¤§å°ï¼ˆä¸€æ¬¡åŠ è½½å¤šå°‘æ¡æ•°æ®ï¼‰æ¥è·å–ä¸åŒçš„æ•°æ®ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å¯¹<code>QuerySet</code>å¯¹è±¡çš„åˆ‡ç‰‡æ“ä½œæ¥å®ç°åˆ†é¡µï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨Djangoæ¡†æ¶å°è£…çš„<code>Paginator</code>å’Œ<code>Page</code>å¯¹è±¡æ¥å®ç°åˆ†é¡µã€‚ä½¿ç”¨DRFæ—¶ï¼Œå¯ä»¥åœ¨Djangoé…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹<code>REST_FRAMEWORK</code>å¹¶é…ç½®é»˜è®¤çš„åˆ†é¡µç±»å’Œé¡µé¢å¤§å°æ¥å®ç°åˆ†é¡µï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=n>REST_FRAMEWORK</span> <span class=o>=</span> <span class=p>{</span>
    <span class=s1>&#39;PAGE_SIZE&#39;</span><span class=p>:</span> <span class=mi>10</span><span class=p>,</span>
    <span class=s1>&#39;DEFAULT_PAGINATION_CLASS&#39;</span><span class=p>:</span> <span class=s1>&#39;rest_framework.pagination.PageNumberPagination&#39;</span>
<span class=p>}</span>
</code></pre></td></tr></table></div></div></div><p>é™¤äº†ä¸Šé¢é…ç½®çš„<code>PageNumberPagination</code>åˆ†é¡µå™¨ä¹‹å¤–ï¼ŒDRFè¿˜æä¾›äº†<code>LimitOffsetPagination</code>å’Œ<code>CursorPagination</code>åˆ†é¡µå™¨ï¼Œå€¼å¾—ä¸€æçš„æ˜¯<code>CursorPagination</code>ï¼Œå®ƒå¯ä»¥é¿å…ä½¿ç”¨é¡µç åˆ†é¡µæ—¶æš´éœ²ç½‘ç«™çš„æ•°æ®ä½“é‡ï¼Œæœ‰å…´è¶£çš„è¯»è€…å¯ä»¥è‡ªè¡Œäº†è§£ã€‚å¦‚æœä¸å¸Œæœ›ä½¿ç”¨é…ç½®æ–‡ä»¶ä¸­é»˜è®¤çš„åˆ†é¡µè®¾å®šï¼Œå¯ä»¥åœ¨è§†å›¾ç±»ä¸­æ·»åŠ ä¸€ä¸ª<code>pagination_class</code>å±æ€§æ¥é‡æ–°æŒ‡å®šåˆ†é¡µå™¨ï¼Œé€šå¸¸å¯ä»¥å°†è¯¥å±æ€§æŒ‡å®šä¸ºè‡ªå®šä¹‰çš„åˆ†é¡µå™¨ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=kn>from</span> <span class=nn>rest_framework.pagination</span> <span class=kn>import</span> <span class=n>PageNumberPagination</span>


<span class=k>class</span> <span class=nc>CustomizedPagination</span><span class=p>(</span><span class=n>PageNumberPagination</span><span class=p>):</span>
    <span class=c1># é»˜è®¤é¡µé¢å¤§å°</span>
    <span class=n>page_size</span> <span class=o>=</span> <span class=mi>5</span>
    <span class=c1># é¡µé¢å¤§å°å¯¹åº”çš„æŸ¥è¯¢å‚æ•°</span>
    <span class=n>page_size_query_param</span> <span class=o>=</span> <span class=s1>&#39;size&#39;</span>
    <span class=c1># é¡µé¢å¤§å°çš„æœ€å¤§å€¼</span>
    <span class=n>max_page_size</span> <span class=o>=</span> <span class=mi>50</span>
</code></pre></td></tr></table></div></div></div><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=k>class</span> <span class=nc>SubjectView</span><span class=p>(</span><span class=n>ListAPIView</span><span class=p>):</span>
    <span class=c1># æŒ‡å®šå¦‚ä½•è·å–æ•°æ®</span>
    <span class=n>queryset</span> <span class=o>=</span> <span class=n>Subject</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>all</span><span class=p>()</span>
    <span class=c1># æŒ‡å®šå¦‚ä½•åºåˆ—åŒ–æ•°æ®</span>
    <span class=n>serializer_class</span> <span class=o>=</span> <span class=n>SubjectSerializer</span>
    <span class=c1># æŒ‡å®šå¦‚ä½•åˆ†é¡µ</span>
    <span class=n>pagination_class</span> <span class=o>=</span> <span class=n>CustomizedPagination</span>
</code></pre></td></tr></table></div></div></div><p>å¦‚æœä¸å¸Œæœ›æ•°æ®åˆ†é¡µï¼Œå¯ä»¥å°†<code>pagination_class</code>å±æ€§è®¾ç½®ä¸º<code>None</code>æ¥å–æ¶ˆé»˜è®¤çš„åˆ†é¡µå™¨ã€‚</p><h3 id=æ•°æ®ç­›é€‰><a href=#æ•°æ®ç­›é€‰ class=anchor-link>#</a>æ•°æ®ç­›é€‰</h3><p>å¦‚æœå¸Œæœ›ä½¿ç”¨CBVå®šåˆ¶è·å–è€å¸ˆä¿¡æ¯çš„æ•°æ®æ¥å£ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ç»§æ‰¿<code>ListAPIView</code>æ¥å®ç°ã€‚ä½†æ˜¯å› ä¸ºè¦é€šè¿‡æŒ‡å®šçš„å­¦ç§‘æ¥è·å–å¯¹åº”çš„è€å¸ˆä¿¡æ¯ï¼Œå› æ­¤éœ€è¦å¯¹è€å¸ˆæ•°æ®è¿›è¡Œç­›é€‰è€Œä¸æ˜¯ç›´æ¥è·å–æ‰€æœ‰è€å¸ˆçš„æ•°æ®ã€‚å¦‚æœæƒ³ä»è¯·æ±‚ä¸­è·å–å­¦ç§‘ç¼–å·å¹¶é€šè¿‡å­¦ç§‘ç¼–å·å¯¹è€å¸ˆè¿›è¡Œç­›é€‰ï¼Œå¯ä»¥é€šè¿‡é‡å†™<code>get_queryset</code>æ–¹æ³•æ¥åšåˆ°ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=k>class</span> <span class=nc>TeacherView</span><span class=p>(</span><span class=n>ListAPIView</span><span class=p>):</span>
    <span class=n>serializer_class</span> <span class=o>=</span> <span class=n>TeacherSerializer</span>

    <span class=k>def</span> <span class=nf>get_queryset</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=n>queryset</span> <span class=o>=</span> <span class=n>Teacher</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>defer</span><span class=p>(</span><span class=s1>&#39;subject&#39;</span><span class=p>)</span>
        <span class=k>try</span><span class=p>:</span>
            <span class=n>sno</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>request</span><span class=o>.</span><span class=n>GET</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;sno&#39;</span><span class=p>,</span> <span class=s1>&#39;&#39;</span><span class=p>)</span>
            <span class=n>queryset</span> <span class=o>=</span> <span class=n>queryset</span><span class=o>.</span><span class=n>filter</span><span class=p>(</span><span class=n>subject__no</span><span class=o>=</span><span class=n>sno</span><span class=p>)</span>
            <span class=k>return</span> <span class=n>queryset</span>
        <span class=k>except</span> <span class=ne>ValueError</span><span class=p>:</span>
            <span class=k>raise</span> <span class=n>Http404</span><span class=p>(</span><span class=s1>&#39;No teachers found.&#39;</span><span class=p>)</span>
</code></pre></td></tr></table></div></div></div><p>é™¤äº†ä¸Šè¿°æ–¹å¼ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ä¸‰æ–¹åº“<code>django-filter</code>æ¥é…åˆDRFå®ç°å¯¹æ•°æ®çš„ç­›é€‰ï¼Œä½¿ç”¨<code>django-filter</code>åï¼Œå¯ä»¥é€šè¿‡ä¸ºè§†å›¾ç±»é…ç½®<code>filter-backends</code>å±æ€§å¹¶æŒ‡å®šä½¿ç”¨<code>DjangoFilterBackend</code>æ¥æ”¯æŒæ•°æ®ç­›é€‰ã€‚åœ¨å®Œæˆä¸Šè¿°é…ç½®åï¼Œå¯ä»¥ä½¿ç”¨<code>filter_fields</code> å±æ€§æˆ–<code>filterset_class</code>å±æ€§æ¥æŒ‡å®šå¦‚ä½•ç­›é€‰æ•°æ®ï¼Œæœ‰å…´è¶£çš„è¯»è€…å¯ä»¥è‡ªè¡Œç ”ç©¶ã€‚</p></div><ul class=post-copyright><li class="copyright-item author"><span class=copyright-item-text>ä½œè€…</span>ï¼š<span class="p-author h-card">éª†æ˜Š</span></li><li class="copyright-item link"><span class=copyright-item-text>é“¾æ¥</span>ï¼š<a href=https://github.com/jackfrued/Python-100-Days target=_blank rel=noopener>https://github.com/jackfrued/Python-100-Days</a></li><li class="copyright-item license"><span class=copyright-item-text>è®¸å¯</span>ï¼šæœ¬æ–‡é‡‡ç”¨<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh target=_blank rel=noopener>ã€ŒCC BY-NC-SA 4.0ã€</a>åè®®ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</li></ul></article><div class=related-posts><h2 class=related-title>ç›¸å…³æ–‡ç« ï¼š<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon related-icon"><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm144 276c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6.0-12-5.4-12-12v-92h-92c-6.6.0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6.0 12 5.4 12 12v92h92c6.6.0 12 5.4 12 12v56z"/></svg></h2><ul class=related-list><li class=related-item><a href=/python/01.%E5%88%9D%E8%AF%86python/ class=related-link>01.åˆè¯†Python</a></li><li class=related-item><a href=/python/02.%E8%AF%AD%E8%A8%80%E5%85%83%E7%B4%A0/ class=related-link>02.è¯­è¨€å…ƒç´ </a></li><li class=related-item><a href=/python/03.%E5%88%86%E6%94%AF%E7%BB%93%E6%9E%84/ class=related-link>03.åˆ†æ”¯ç»“æ„</a></li><li class=related-item><a href=/python/04.%E5%BE%AA%E7%8E%AF%E7%BB%93%E6%9E%84/ class=related-link>04.å¾ªç¯ç»“æ„</a></li><li class=related-item><a href=/python/05.%E6%9E%84%E9%80%A0%E7%A8%8B%E5%BA%8F%E9%80%BB%E8%BE%91/ class=related-link>05.æ„é€ ç¨‹åºé€»è¾‘</a></li></ul></div><div class=post-tags><a href=/tags/python/ rel=tag class=post-tags-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon tag-icon"><path d="M0 252.118V48C0 21.49 21.49.0 48 0h204.118a48 48 0 0133.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137.0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882.0L14.059 286.059A48 48 0 010 252.118zM112 64c-26.51.0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z"/></svg>python</a></div></div></main><div id=back-to-top class=back-to-top><a href=#><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon arrow-up"><path d="M34.9 289.5l-22.2-22.2c-9.4-9.4-9.4-24.6.0-33.9L207 39c9.4-9.4 24.6-9.4 33.9.0l194.3 194.3c9.4 9.4 9.4 24.6.0 33.9L413 289.4c-9.5 9.5-25 9.3-34.3-.4L264 168.6V456c0 13.3-10.7 24-24 24h-32c-13.3.0-24-10.7-24-24V168.6L69.2 289.1c-9.3 9.8-24.8 10-34.3.4z"/></svg></a></div><footer id=footer class=footer><div class=footer-inner><div class=site-info>Â©&nbsp;2021â€“2022&nbsp;<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon footer-icon"><path d="M462.3 62.6C407.5 15.9 326 24.3 275.7 76.2L256 96.5l-19.7-20.3C186.1 24.3 104.5 15.9 49.7 62.6c-62.8 53.6-66.1 149.8-9.9 207.9l193.5 199.8c12.5 12.9 32.8 12.9 45.3.0l193.5-199.8c56.3-58.1 53-154.3-9.8-207.9z"/></svg>&nbsp;hanxin</div><script src=https://sdk.jinrishici.com/v2/browser/jinrishici.js></script>
<text class=poem_sentence></text>
<text class=poem_info></text>
<script type=text/javascript>jinrishici.load(function(a){var b=document.querySelector(".poem_sentence"),c=document.querySelector(".poem_info");b.innerHTML=a.data.content,c.innerHTML='â€”â€”'+a.data.origin.author})</script></div></footer></div><script src=https://cdn.jsdelivr.net/npm/medium-zoom@latest/dist/medium-zoom.min.js></script>
<script>mediumZoom(document.querySelectorAll('div.post-body img'),{background:'hsla(var(--color-bg-h), var(--color-bg-s), var(--color-bg-l), 0.95)'})</script><script src=https://cdn.jsdelivr.net/npm/instant.page@5.1.0/instantpage.min.js type=module defer></script></body></html>