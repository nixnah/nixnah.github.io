<!doctype html><html lang=zh-cn><head prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#"><meta charset=utf-8><meta name=generator content="Hugo 0.91.2"><meta name=theme-color content="#16171d"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=format-detection content="telephone=no, date=no, address=no, email=no"><meta http-equiv=cache-control content="no-transform"><meta http-equiv=cache-control content="no-siteapp"><title>43.静态资源和Ajax请求 | Hanxin</title><link rel=stylesheet href=/css/meme.min.88c90dc75021618344ec926f4ed6ac307f30ba48911294816b16370a41e5f137.css><script src=/js/meme.min.f460a174bb100a60a7e275913695161f1e09aab1378fe99cfd30cde14da70888.js></script>
<link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400;0,500;0,700;1,400;1,700&family=Noto+Serif+SC:wght@400;500;700&family=Source+Code+Pro:ital,wght@0,400;0,700;1,400;1,700&family=Satisfy&family=Klee+One:wght@400;600&family=Great+Vibes&display=swap" media=print onload="this.media='all'"><noscript><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400;0,500;0,700;1,400;1,700&family=Noto+Serif+SC:wght@400;500;700&family=Source+Code+Pro:ital,wght@0,400;0,700;1,400;1,700&family=Satisfy&family=Klee+One:wght@400;600&family=Great+Vibes&display=swap"></noscript><meta name=author content="骆昊"><meta name=description content="静态资源和Ajax请求 加载静态资源 如果要在Django项目中使用静态资源，可以先创建……"><link rel="shortcut icon" href=/favicon.ico type=image/x-icon><link rel=mask-icon href=/icons/safari-pinned-tab.svg color=#2a6df4><link rel=apple-touch-icon sizes=180x180 href=/icons/apple-touch-icon.png><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-title content="Hanxin"><meta name=apple-mobile-web-app-status-bar-style content="black"><meta name=mobile-web-app-capable content="yes"><meta name=application-name content="Hanxin"><meta name=msapplication-starturl content="../../"><meta name=msapplication-TileColor content="#fff"><meta name=msapplication-TileImage content="../../icons/mstile-150x150.png"><link rel=manifest href=/manifest.json><link rel=canonical href=/python/43.%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E5%92%8Cajax%E8%AF%B7%E6%B1%82/><script type=application/ld+json>{"@context":"https://schema.org","@type":"WebPage","datePublished":"2021-08-23T17:34:41+08:00","dateModified":"2022-01-16T09:24:35+00:00","url":"/python/43.%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E5%92%8Cajax%E8%AF%B7%E6%B1%82/","name":"43.静态资源和Ajax请求","description":"静态资源和Ajax请求 加载静态资源 如果要在Django项目中使用静态资源，可以先创建……","image":"/icons/apple-touch-icon.png","license":"本文采用[「CC BY-NC-SA 4.0」](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)协议，转载请注明出处。","publisher":{"@type":"Organization","name":"Hanxin","logo":{"@type":"ImageObject","url":"/icons/apple-touch-icon.png"},"url":"/"},"mainEntityOfPage":{"@type":"WebSite","@id":"/"}}</script><meta name=twitter:card content="summary"><meta property="og:title" content="43.静态资源和Ajax请求"><meta property="og:description" content="静态资源和Ajax请求 加载静态资源 如果要在Django项目中使用静态资源，可以先创建……"><meta property="og:url" content="/python/43.%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E5%92%8Cajax%E8%AF%B7%E6%B1%82/"><meta property="og:site_name" content="Hanxin"><meta property="og:locale" content="zh"><meta property="og:image" content="/icons/apple-touch-icon.png"><meta property="og:type" content="website"></head><body><div class=container><header class=header><div class=header-wrapper><div class="header-inner single"><div class=site-brand><a href=/ class=brand>Hanxin</a></div><nav class=nav><ul class=menu id=menu><li class=menu-item><a href=/life/><span class=menu-item-name>生活</span></a></li><li class=menu-item><a href=/tech/><span class=menu-item-name>技术</span></a></li><li class=menu-item><a href=/tags/><span class=menu-item-name>标签</span></a></li><li class=menu-item><a href=/about/><span class=menu-item-name>关于</span></a></li><li class=menu-item><a href=/blogroll/><span class=menu-item-name>友链</span></a></li><li class=menu-item><a href=/python/><span class=menu-item-name>Python-100天</span></a></li><li class=menu-item><a id=theme-switcher href=#><span class="icon theme-icon-light">🌞</span><span class="icon theme-icon-dark">🌙</span></a></li></ul></nav></div></div><input type=checkbox id=nav-toggle aria-hidden=true>
<label for=nav-toggle class=nav-toggle></label>
<label for=nav-toggle class=nav-curtain></label></header><main class="main single" id=main><div class=main-inner><article class="content post h-entry" data-align=justify data-type=python data-toc-num=true><h1 class="post-title p-name">43.静态资源和Ajax请求</h1><div class=post-meta><time datetime=2021-08-23T17:34:41+08:00 class="post-meta-item published dt-published"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon post-meta-icon"><path d="M148 288h-40c-6.6.0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h40c6.6.0 12 5.4 12 12v40c0 6.6-5.4 12-12 12zm108-12v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm-96 96v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm-96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm192 0v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm96-260v352c0 26.5-21.5 48-48 48H48c-26.5.0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h48V12c0-6.6 5.4-12 12-12h40c6.6.0 12 5.4 12 12v52h128V12c0-6.6 5.4-12 12-12h40c6.6.0 12 5.4 12 12v52h48c26.5.0 48 21.5 48 48zm-48 346V160H48v298c0 3.3 2.7 6 6 6h340c3.3.0 6-2.7 6-6z"/></svg>&nbsp;2021.8.23</time>
<time datetime=2022-01-16T09:24:35+00:00 class="post-meta-item modified dt-updated"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon post-meta-icon"><path d="M4e2 64h-48V12c0-6.627-5.373-12-12-12h-40c-6.627.0-12 5.373-12 12v52H160V12c0-6.627-5.373-12-12-12h-40c-6.627.0-12 5.373-12 12v52H48C21.49 64 0 85.49.0 112v352c0 26.51 21.49 48 48 48h352c26.51.0 48-21.49 48-48V112c0-26.51-21.49-48-48-48zm-6 4e2H54a6 6 0 01-6-6V160h352v298a6 6 0 01-6 6zm-52.849-200.65L198.842 404.519c-4.705 4.667-12.303 4.637-16.971-.068l-75.091-75.699c-4.667-4.705-4.637-12.303.068-16.971l22.719-22.536c4.705-4.667 12.303-4.637 16.97.069l44.104 44.461 111.072-110.181c4.705-4.667 12.303-4.637 16.971.068l22.536 22.718c4.667 4.705 4.636 12.303-.069 16.97z"/></svg>&nbsp;2022.1.16</time>
<span class="post-meta-item wordcount"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon post-meta-icon"><path d="M497.9 142.1l-46.1 46.1c-4.7 4.7-12.3 4.7-17 0l-111-111c-4.7-4.7-4.7-12.3.0-17l46.1-46.1c18.7-18.7 49.1-18.7 67.9.0l60.1 60.1c18.8 18.7 18.8 49.1.0 67.9zM284.2 99.8 21.6 362.4.4 483.9c-2.9 16.4 11.4 30.6 27.8 27.8l121.5-21.3 262.6-262.6c4.7-4.7 4.7-12.3.0-17l-111-111c-4.8-4.7-12.4-4.7-17.1.0zM124.1 339.9c-5.5-5.5-5.5-14.3.0-19.8l154-154c5.5-5.5 14.3-5.5 19.8.0s5.5 14.3.0 19.8l-154 154c-5.5 5.5-14.3 5.5-19.8.0zM88 424h48v36.3l-64.5 11.3-31.1-31.1L51.7 376H88v48z"/></svg>&nbsp;2147</span>
<span class="post-meta-item reading-time"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon post-meta-icon"><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm0 448c-110.5.0-2e2-89.5-2e2-2e2S145.5 56 256 56s2e2 89.5 2e2 2e2-89.5 2e2-2e2 2e2zm61.8-104.4-84.9-61.7c-3.1-2.3-4.9-5.9-4.9-9.7V116c0-6.6 5.4-12 12-12h32c6.6.0 12 5.4 12 12v141.7l66.8 48.6c5.4 3.9 6.5 11.4 2.6 16.8L334.6 349c-3.9 5.3-11.4 6.5-16.8 2.6z"/></svg>&nbsp;5&nbsp;分钟</span></div><div class="post-body e-content"><h2 id=静态资源和ajax请求><a href=#静态资源和ajax请求 class=anchor-link>#</a>静态资源和Ajax请求</h2><h3 id=加载静态资源><a href=#加载静态资源 class=anchor-link>#</a>加载静态资源</h3><p>如果要在Django项目中使用静态资源，可以先创建一个用于保存静态资源的目录。在<code>vote</code>项目中，我们将静态资源置于名为<code>static</code>的文件夹中，在该文件夹包含了三个子文件夹：css、js和images，分别用来保存外部CSS文件、外部JavaScript文件和图片资源，如下图所示。</p><p><img src=/res/pycharm-django-static.png alt></p><p>为了能够找到保存静态资源的文件夹，我们还需要修改Django项目的配置文件<code>settings.py</code>，如下所示：</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=n>STATICFILES_DIRS</span> <span class=o>=</span> <span class=p>[</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>BASE_DIR</span><span class=p>,</span> <span class=s1>&#39;static&#39;</span><span class=p>),</span> <span class=p>]</span>
<span class=n>STATIC_URL</span> <span class=o>=</span> <span class=s1>&#39;/static/&#39;</span>
</code></pre></td></tr></table></div></div></div><p>配置好静态资源之后，大家可以运行项目，然后看看之前我们写的页面上的图片是否能够正常加载出来。需要说明的是，在项目正式部署到线上环境后，我们通常会把静态资源交给专门的静态资源服务器（如Nginx、Apache）来处理，而不是有运行Python代码的服务器来管理静态资源，所以上面的配置并不适用于生产环境，仅供项目开发阶段测试使用。使用静态资源的正确姿势我们会在后续的章节为大家讲解。</p><h3 id=ajax概述><a href=#ajax概述 class=anchor-link>#</a>Ajax概述</h3><p>接下来就可以实现“好评”和“差评”的功能了，很明显如果能够在不刷新页面的情况下实现这两个功能会带来更好的用户体验，因此我们考虑使用<a href=https://zh.wikipedia.org/wiki/AJAX target=_blank rel=noopener>Ajax</a>技术来实现“好评”和“差评”。Ajax是Asynchronous Javascript And XML的缩写 , 简单的说，使用Ajax技术可以在不重新加载整个页面的情况下对页面进行局部刷新。</p><p>对于传统的Web应用，每次页面上需要加载新的内容都需要重新请求服务器并刷新整个页面，如果服务器短时间内无法给予响应或者网络状况并不理想，那么可能会造成浏览器长时间的空白并使得用户处于等待状态，在这个期间用户什么都做不了，如下图所示。很显然，这样的Web应用并不能带来很好的用户体验。</p><p><img src=/res/synchronous-web-request.png alt></p><p>对于使用Ajax技术的Web应用，浏览器可以向服务器发起异步请求来获取数据。异步请求不会中断用户体验，当服务器返回了新的数据，我们可以通过JavaScript代码进行DOM操作来实现对页面的局部刷新，这样就相当于在不刷新整个页面的情况下更新了页面的内容，如下图所示。</p><p><img src=/res/asynchronous-web-request.png alt></p><p>在使用Ajax技术时，浏览器跟服务器通常会交换XML或JSON格式的数据，XML是以前使用得非常多的一种数据格式，近年来几乎已经完全被JSON取代，下面是两种数据格式的对比。</p><p>XML格式：</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-XML data-lang=XML><span class=cp>&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt;</span>
<span class=nt>&lt;message&gt;</span>
	<span class=nt>&lt;from&gt;</span>Alice<span class=nt>&lt;/from&gt;</span>
    <span class=nt>&lt;to&gt;</span>Bob<span class=nt>&lt;/to&gt;</span>
    <span class=nt>&lt;content&gt;</span>Dinner is on me!<span class=nt>&lt;/content&gt;</span>
<span class=nt>&lt;/message&gt;</span>
</code></pre></td></tr></table></div></div></div><p>JSON格式：</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JSON data-lang=JSON><span class=p>{</span>
    <span class=nt>&#34;from&#34;</span><span class=p>:</span> <span class=s2>&#34;Alice&#34;</span><span class=p>,</span>
    <span class=nt>&#34;to&#34;</span><span class=p>:</span> <span class=s2>&#34;Bob&#34;</span><span class=p>,</span>
    <span class=nt>&#34;content&#34;</span><span class=p>:</span> <span class=s2>&#34;Dinner is on me!&#34;</span>
<span class=p>}</span>
</code></pre></td></tr></table></div></div></div><p>通过上面的对比，明显JSON格式的数据要紧凑得多，所以传输效率更高，而且JSON本身也是JavaScript中的一种对象表达式语法，在JavaScript代码中处理JSON格式的数据更加方便。</p><h3 id=用ajax实现投票功能><a href=#用ajax实现投票功能 class=anchor-link>#</a>用Ajax实现投票功能</h3><p>下面，我们使用Ajax技术来实现投票的功能，首先修改项目的<code>urls.py</code>文件，为“好评”和“差评”功能映射对应的URL。</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=kn>from</span> <span class=nn>django.contrib</span> <span class=kn>import</span> <span class=n>admin</span>
<span class=kn>from</span> <span class=nn>django.urls</span> <span class=kn>import</span> <span class=n>path</span>

<span class=kn>from</span> <span class=nn>vote</span> <span class=kn>import</span> <span class=n>views</span>

<span class=n>urlpatterns</span> <span class=o>=</span> <span class=p>[</span>
    <span class=n>path</span><span class=p>(</span><span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=n>views</span><span class=o>.</span><span class=n>show_subjects</span><span class=p>),</span>
    <span class=n>path</span><span class=p>(</span><span class=s1>&#39;teachers/&#39;</span><span class=p>,</span> <span class=n>views</span><span class=o>.</span><span class=n>show_teachers</span><span class=p>),</span>
    <span class=n>path</span><span class=p>(</span><span class=s1>&#39;praise/&#39;</span><span class=p>,</span> <span class=n>views</span><span class=o>.</span><span class=n>prise_or_criticize</span><span class=p>),</span>
    <span class=n>path</span><span class=p>(</span><span class=s1>&#39;criticize/&#39;</span><span class=p>,</span> <span class=n>views</span><span class=o>.</span><span class=n>prise_or_criticize</span><span class=p>),</span>
    <span class=n>path</span><span class=p>(</span><span class=s1>&#39;admin/&#39;</span><span class=p>,</span> <span class=n>admin</span><span class=o>.</span><span class=n>site</span><span class=o>.</span><span class=n>urls</span><span class=p>),</span>
<span class=p>]</span>
</code></pre></td></tr></table></div></div></div><p>设计视图函数<code>praise_or_criticize</code>来支持“好评”和“差评”功能，该视图函数通过Django封装的JsonResponse类将字典序列化成JSON字符串作为返回给浏览器的响应内容。</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=k>def</span> <span class=nf>praise_or_criticize</span><span class=p>(</span><span class=n>request</span><span class=p>):</span>
    <span class=s2>&#34;&#34;&#34;好评&#34;&#34;&#34;</span>
    <span class=k>try</span><span class=p>:</span>
        <span class=n>tno</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>request</span><span class=o>.</span><span class=n>GET</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;tno&#39;</span><span class=p>))</span>
        <span class=n>teacher</span> <span class=o>=</span> <span class=n>Teacher</span><span class=o>.</span><span class=n>objects</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>no</span><span class=o>=</span><span class=n>tno</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>request</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s1>&#39;/praise&#39;</span><span class=p>):</span>
            <span class=n>teacher</span><span class=o>.</span><span class=n>good_count</span> <span class=o>+=</span> <span class=mi>1</span>
            <span class=n>count</span> <span class=o>=</span> <span class=n>teacher</span><span class=o>.</span><span class=n>good_count</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>teacher</span><span class=o>.</span><span class=n>bad_count</span> <span class=o>+=</span> <span class=mi>1</span>
            <span class=n>count</span> <span class=o>=</span> <span class=n>teacher</span><span class=o>.</span><span class=n>bad_count</span>
        <span class=n>teacher</span><span class=o>.</span><span class=n>save</span><span class=p>()</span>
        <span class=n>data</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;code&#39;</span><span class=p>:</span> <span class=mi>20000</span><span class=p>,</span> <span class=s1>&#39;mesg&#39;</span><span class=p>:</span> <span class=s1>&#39;操作成功&#39;</span><span class=p>,</span> <span class=s1>&#39;count&#39;</span><span class=p>:</span> <span class=n>count</span><span class=p>}</span>
    <span class=k>except</span> <span class=p>(</span><span class=ne>ValueError</span><span class=p>,</span> <span class=n>Teacher</span><span class=o>.</span><span class=n>DoseNotExist</span><span class=p>):</span>
        <span class=n>data</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;code&#39;</span><span class=p>:</span> <span class=mi>20001</span><span class=p>,</span> <span class=s1>&#39;mesg&#39;</span><span class=p>:</span> <span class=s1>&#39;操作失败&#39;</span><span class=p>}</span>
    <span class=k>return</span> <span class=n>JsonResponse</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</code></pre></td></tr></table></div></div></div><p>修改显示老师信息的模板页，引入jQuery库来实现事件处理、Ajax请求和DOM操作。</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span><span class=lnt>89
</span><span class=lnt>90
</span><span class=lnt>91
</span><span class=lnt>92
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-HTML data-lang=HTML><span class=cp>&lt;!DOCTYPE html&gt;</span>
<span class=p>&lt;</span><span class=nt>html</span> <span class=na>lang</span><span class=o>=</span><span class=s>&#34;en&#34;</span><span class=p>&gt;</span>
<span class=p>&lt;</span><span class=nt>head</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>meta</span> <span class=na>charset</span><span class=o>=</span><span class=s>&#34;UTF-8&#34;</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>title</span><span class=p>&gt;</span>老师信息<span class=p>&lt;/</span><span class=nt>title</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>style</span><span class=p>&gt;</span>
        <span class=p>#</span><span class=nn>container</span> <span class=p>{</span>
            <span class=k>width</span><span class=p>:</span> <span class=mi>80</span><span class=kt>%</span><span class=p>;</span>
            <span class=k>margin</span><span class=p>:</span> <span class=mi>10</span><span class=kt>px</span> <span class=kc>auto</span><span class=p>;</span>
        <span class=p>}</span>
        <span class=p>.</span><span class=nc>teacher</span> <span class=p>{</span>
            <span class=k>width</span><span class=p>:</span> <span class=mi>100</span><span class=kt>%</span><span class=p>;</span>
            <span class=k>margin</span><span class=p>:</span> <span class=mi>0</span> <span class=kc>auto</span><span class=p>;</span>
            <span class=k>padding</span><span class=p>:</span> <span class=mi>10</span><span class=kt>px</span> <span class=mi>0</span><span class=p>;</span>
            <span class=k>border-bottom</span><span class=p>:</span> <span class=mi>1</span><span class=kt>px</span> <span class=kc>dashed</span> <span class=kc>gray</span><span class=p>;</span>
            <span class=k>overflow</span><span class=p>:</span> <span class=kc>auto</span><span class=p>;</span>
        <span class=p>}</span>
        <span class=p>.</span><span class=nc>teacher</span><span class=o>&gt;</span><span class=nt>div</span> <span class=p>{</span>
            <span class=k>float</span><span class=p>:</span> <span class=kc>left</span><span class=p>;</span>
        <span class=p>}</span>
        <span class=p>.</span><span class=nc>photo</span> <span class=p>{</span>
            <span class=k>height</span><span class=p>:</span> <span class=mi>140</span><span class=kt>px</span><span class=p>;</span>
            <span class=k>border-radius</span><span class=p>:</span> <span class=mi>75</span><span class=kt>px</span><span class=p>;</span>
            <span class=k>overflow</span><span class=p>:</span> <span class=kc>hidden</span><span class=p>;</span>
            <span class=k>margin-left</span><span class=p>:</span> <span class=mi>20</span><span class=kt>px</span><span class=p>;</span>
        <span class=p>}</span>
        <span class=p>.</span><span class=nc>info</span> <span class=p>{</span>
            <span class=k>width</span><span class=p>:</span> <span class=mi>75</span><span class=kt>%</span><span class=p>;</span>
            <span class=k>margin-left</span><span class=p>:</span> <span class=mi>30</span><span class=kt>px</span><span class=p>;</span>
        <span class=p>}</span>
        <span class=p>.</span><span class=nc>info</span> <span class=nt>div</span> <span class=p>{</span>
            <span class=k>clear</span><span class=p>:</span> <span class=kc>both</span><span class=p>;</span>
            <span class=k>margin</span><span class=p>:</span> <span class=mi>5</span><span class=kt>px</span> <span class=mi>10</span><span class=kt>px</span><span class=p>;</span>
        <span class=p>}</span>
        <span class=p>.</span><span class=nc>info</span> <span class=nt>span</span> <span class=p>{</span>
            <span class=k>margin-right</span><span class=p>:</span> <span class=mi>25</span><span class=kt>px</span><span class=p>;</span>
        <span class=p>}</span>
        <span class=p>.</span><span class=nc>info</span> <span class=nt>a</span> <span class=p>{</span>
            <span class=k>text-decoration</span><span class=p>:</span> <span class=kc>none</span><span class=p>;</span>
            <span class=k>color</span><span class=p>:</span> <span class=kc>darkcyan</span><span class=p>;</span>
        <span class=p>}</span>
    <span class=p>&lt;/</span><span class=nt>style</span><span class=p>&gt;</span>
<span class=p>&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>
<span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;container&#34;</span><span class=p>&gt;</span>
        <span class=p>&lt;</span><span class=nt>h1</span><span class=p>&gt;</span>{{ subject.name }}学科的老师信息<span class=p>&lt;/</span><span class=nt>h1</span><span class=p>&gt;</span>
        <span class=p>&lt;</span><span class=nt>hr</span><span class=p>&gt;</span>
        {% if not teachers %}
            <span class=p>&lt;</span><span class=nt>h2</span><span class=p>&gt;</span>暂无该学科老师信息<span class=p>&lt;/</span><span class=nt>h2</span><span class=p>&gt;</span>
        {% endif %}
        {% for teacher in teachers %}
        <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;teacher&#34;</span><span class=p>&gt;</span>
            <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;photo&#34;</span><span class=p>&gt;</span>
                <span class=p>&lt;</span><span class=nt>img</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;/static/images/{{ teacher.photo }}&#34;</span> <span class=na>height</span><span class=o>=</span><span class=s>&#34;140&#34;</span> <span class=na>alt</span><span class=o>=</span><span class=s>&#34;&#34;</span><span class=p>&gt;</span>
            <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
            <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;info&#34;</span><span class=p>&gt;</span>
                <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
                    <span class=p>&lt;</span><span class=nt>span</span><span class=p>&gt;&lt;</span><span class=nt>strong</span><span class=p>&gt;</span>姓名：{{ teacher.name }}<span class=p>&lt;/</span><span class=nt>strong</span><span class=p>&gt;&lt;/</span><span class=nt>span</span><span class=p>&gt;</span>
                    <span class=p>&lt;</span><span class=nt>span</span><span class=p>&gt;</span>性别：{{ teacher.sex | yesno:&#39;男,女&#39; }}<span class=p>&lt;/</span><span class=nt>span</span><span class=p>&gt;</span>
                    <span class=p>&lt;</span><span class=nt>span</span><span class=p>&gt;</span>出生日期：{{ teacher.birth }}<span class=p>&lt;/</span><span class=nt>span</span><span class=p>&gt;</span>
                <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
                <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;intro&#34;</span><span class=p>&gt;</span>{{ teacher.intro }}<span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
                <span class=p>&lt;</span><span class=nt>div</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;comment&#34;</span><span class=p>&gt;</span>
                    <span class=p>&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;/praise/?tno={{ teacher.no }}&#34;</span><span class=p>&gt;</span>好评<span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span><span class=ni>&amp;nbsp;&amp;nbsp;</span>
                    (<span class=p>&lt;</span><span class=nt>strong</span><span class=p>&gt;</span>{{ teacher.good_count }}<span class=p>&lt;/</span><span class=nt>strong</span><span class=p>&gt;</span>)
                    <span class=ni>&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;</span>
                    <span class=p>&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;/criticize/?tno={{ teacher.no }}&#34;</span><span class=p>&gt;</span>差评<span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span><span class=ni>&amp;nbsp;&amp;nbsp;</span>
                    (<span class=p>&lt;</span><span class=nt>strong</span><span class=p>&gt;</span>{{ teacher.bad_count }}<span class=p>&lt;/</span><span class=nt>strong</span><span class=p>&gt;</span>)
                <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
            <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
        <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
        {% endfor %}
        <span class=p>&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;/&#34;</span><span class=p>&gt;</span>返回首页<span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span>
    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
        <span class=nx>$</span><span class=p>(()</span> <span class=p>=&gt;</span> <span class=p>{</span>
            <span class=nx>$</span><span class=p>(</span><span class=s1>&#39;.comment&gt;a&#39;</span><span class=p>).</span><span class=nx>on</span><span class=p>(</span><span class=s1>&#39;click&#39;</span><span class=p>,</span> <span class=p>(</span><span class=nx>evt</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
                <span class=nx>evt</span><span class=p>.</span><span class=nx>preventDefault</span><span class=p>()</span>
                <span class=kd>let</span> <span class=nx>url</span> <span class=o>=</span> <span class=nx>$</span><span class=p>(</span><span class=nx>evt</span><span class=p>.</span><span class=nx>target</span><span class=p>).</span><span class=nx>attr</span><span class=p>(</span><span class=s1>&#39;href&#39;</span><span class=p>)</span>
                <span class=nx>$</span><span class=p>.</span><span class=nx>getJSON</span><span class=p>(</span><span class=nx>url</span><span class=p>,</span> <span class=p>(</span><span class=nx>json</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
                    <span class=k>if</span> <span class=p>(</span><span class=nx>json</span><span class=p>.</span><span class=nx>code</span> <span class=o>==</span> <span class=mi>20000</span><span class=p>)</span> <span class=p>{</span>
                        <span class=nx>$</span><span class=p>(</span><span class=nx>evt</span><span class=p>.</span><span class=nx>target</span><span class=p>).</span><span class=nx>next</span><span class=p>().</span><span class=nx>text</span><span class=p>(</span><span class=nx>json</span><span class=p>.</span><span class=nx>count</span><span class=p>)</span>
                    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
                        <span class=nx>alert</span><span class=p>(</span><span class=nx>json</span><span class=p>.</span><span class=nx>mesg</span><span class=p>)</span>
                    <span class=p>}</span>
                <span class=p>})</span>
            <span class=p>})</span>
        <span class=p>})</span>
    <span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
<span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
<span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</code></pre></td></tr></table></div></div></div><p>上面的前端代码中，使用了jQuery库封装的<code>getJSON</code>方法向服务器发送异步请求，如果不熟悉前端的jQuery库，可以参考<a href=https://www.runoob.com/manual/jquery/ target=_blank rel=noopener>《jQuery API手册》</a>。</p><h3 id=小结><a href=#小结 class=anchor-link>#</a>小结</h3><p>到此为止，这个投票项目的核心功能已然完成，在下面的章节中我们会要求用户必须登录才能投票，没有账号的用户可以通过注册功能注册一个账号。</p></div><ul class=post-copyright><li class="copyright-item author"><span class=copyright-item-text>作者</span>：<span class="p-author h-card">骆昊</span></li><li class="copyright-item link"><span class=copyright-item-text>链接</span>：<a href=https://github.com/jackfrued/Python-100-Days target=_blank rel=noopener>https://github.com/jackfrued/Python-100-Days</a></li><li class="copyright-item license"><span class=copyright-item-text>许可</span>：本文采用<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh target=_blank rel=noopener>「CC BY-NC-SA 4.0」</a>协议，转载请注明出处。</li></ul></article><div class=related-posts><h2 class=related-title>相关文章：<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon related-icon"><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm144 276c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6.0-12-5.4-12-12v-92h-92c-6.6.0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6.0 12 5.4 12 12v92h92c6.6.0 12 5.4 12 12v56z"/></svg></h2><ul class=related-list><li class=related-item><a href=/python/01.%E5%88%9D%E8%AF%86python/ class=related-link>01.初识Python</a></li><li class=related-item><a href=/python/02.%E8%AF%AD%E8%A8%80%E5%85%83%E7%B4%A0/ class=related-link>02.语言元素</a></li><li class=related-item><a href=/python/03.%E5%88%86%E6%94%AF%E7%BB%93%E6%9E%84/ class=related-link>03.分支结构</a></li><li class=related-item><a href=/python/04.%E5%BE%AA%E7%8E%AF%E7%BB%93%E6%9E%84/ class=related-link>04.循环结构</a></li><li class=related-item><a href=/python/05.%E6%9E%84%E9%80%A0%E7%A8%8B%E5%BA%8F%E9%80%BB%E8%BE%91/ class=related-link>05.构造程序逻辑</a></li></ul></div><div class=post-tags><a href=/tags/python/ rel=tag class=post-tags-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon tag-icon"><path d="M0 252.118V48C0 21.49 21.49.0 48 0h204.118a48 48 0 0133.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137.0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882.0L14.059 286.059A48 48 0 010 252.118zM112 64c-26.51.0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z"/></svg>python</a></div></div></main><div id=back-to-top class=back-to-top><a href=#><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon arrow-up"><path d="M34.9 289.5l-22.2-22.2c-9.4-9.4-9.4-24.6.0-33.9L207 39c9.4-9.4 24.6-9.4 33.9.0l194.3 194.3c9.4 9.4 9.4 24.6.0 33.9L413 289.4c-9.5 9.5-25 9.3-34.3-.4L264 168.6V456c0 13.3-10.7 24-24 24h-32c-13.3.0-24-10.7-24-24V168.6L69.2 289.1c-9.3 9.8-24.8 10-34.3.4z"/></svg></a></div><footer id=footer class=footer><div class=footer-inner><div class=site-info>©&nbsp;2021–2022&nbsp;<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon footer-icon"><path d="M462.3 62.6C407.5 15.9 326 24.3 275.7 76.2L256 96.5l-19.7-20.3C186.1 24.3 104.5 15.9 49.7 62.6c-62.8 53.6-66.1 149.8-9.9 207.9l193.5 199.8c12.5 12.9 32.8 12.9 45.3.0l193.5-199.8c56.3-58.1 53-154.3-9.8-207.9z"/></svg>&nbsp;hanxin</div><script src=https://sdk.jinrishici.com/v2/browser/jinrishici.js></script>
<text class=poem_sentence></text>
<text class=poem_info></text>
<script type=text/javascript>jinrishici.load(function(a){var b=document.querySelector(".poem_sentence"),c=document.querySelector(".poem_info");b.innerHTML=a.data.content,c.innerHTML='——'+a.data.origin.author})</script></div></footer></div><script src=https://cdn.jsdelivr.net/npm/medium-zoom@latest/dist/medium-zoom.min.js></script>
<script>mediumZoom(document.querySelectorAll('div.post-body img'),{background:'hsla(var(--color-bg-h), var(--color-bg-s), var(--color-bg-l), 0.95)'})</script><script src=https://cdn.jsdelivr.net/npm/instant.page@5.1.0/instantpage.min.js type=module defer></script></body></html>