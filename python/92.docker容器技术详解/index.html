<!doctype html><html lang=zh-cn><head prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#"><meta charset=utf-8><meta name=generator content="Hugo 0.91.2"><meta name=theme-color content="#16171d"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=format-detection content="telephone=no, date=no, address=no, email=no"><meta http-equiv=cache-control content="no-transform"><meta http-equiv=cache-control content="no-siteapp"><title>92.Dockerå®¹å™¨æŠ€æœ¯è¯¦è§£ | Hanxin</title><link rel=stylesheet href=/css/meme.min.88c90dc75021618344ec926f4ed6ac307f30ba48911294816b16370a41e5f137.css><script src=/js/meme.min.f460a174bb100a60a7e275913695161f1e09aab1378fe99cfd30cde14da70888.js></script>
<link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400;0,500;0,700;1,400;1,700&family=Noto+Serif+SC:wght@400;500;700&family=Source+Code+Pro:ital,wght@0,400;0,700;1,400;1,700&family=Satisfy&family=Klee+One:wght@400;600&family=Great+Vibes&display=swap" media=print onload="this.media='all'"><noscript><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400;0,500;0,700;1,400;1,700&family=Noto+Serif+SC:wght@400;500;700&family=Source+Code+Pro:ital,wght@0,400;0,700;1,400;1,700&family=Satisfy&family=Klee+One:wght@400;600&family=Great+Vibes&display=swap"></noscript><meta name=author content="éª†æ˜Š"><meta name=description content="Dockerå®¹å™¨æŠ€æœ¯è¯¦è§£ Dockeræ˜¯åŸºäºGoè¯­è¨€å¼€å‘çš„å¼€æºåº”ç”¨å®¹å™¨å¼•æ“ï¼Œéµä»Apaâ€¦â€¦"><link rel="shortcut icon" href=/favicon.ico type=image/x-icon><link rel=mask-icon href=/icons/safari-pinned-tab.svg color=#2a6df4><link rel=apple-touch-icon sizes=180x180 href=/icons/apple-touch-icon.png><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-title content="Hanxin"><meta name=apple-mobile-web-app-status-bar-style content="black"><meta name=mobile-web-app-capable content="yes"><meta name=application-name content="Hanxin"><meta name=msapplication-starturl content="../../"><meta name=msapplication-TileColor content="#fff"><meta name=msapplication-TileImage content="../../icons/mstile-150x150.png"><link rel=manifest href=/manifest.json><link rel=canonical href=/python/92.docker%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF%E8%AF%A6%E8%A7%A3/><script type=application/ld+json>{"@context":"https://schema.org","@type":"WebPage","datePublished":"2021-08-23T17:33:56+08:00","dateModified":"2022-01-16T09:24:35+00:00","url":"/python/92.docker%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF%E8%AF%A6%E8%A7%A3/","name":"92.Dockerå®¹å™¨æŠ€æœ¯è¯¦è§£","description":"Dockerå®¹å™¨æŠ€æœ¯è¯¦è§£ Dockeræ˜¯åŸºäºGoè¯­è¨€å¼€å‘çš„å¼€æºåº”ç”¨å®¹å™¨å¼•æ“ï¼Œéµä»Apaâ€¦â€¦","image":"/icons/apple-touch-icon.png","license":"æœ¬æ–‡é‡‡ç”¨[ã€ŒCC BY-NC-SA 4.0ã€](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)åè®®ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚","publisher":{"@type":"Organization","name":"Hanxin","logo":{"@type":"ImageObject","url":"/icons/apple-touch-icon.png"},"url":"/"},"mainEntityOfPage":{"@type":"WebSite","@id":"/"}}</script><meta name=twitter:card content="summary"><meta property="og:title" content="92.Dockerå®¹å™¨æŠ€æœ¯è¯¦è§£"><meta property="og:description" content="Dockerå®¹å™¨æŠ€æœ¯è¯¦è§£ Dockeræ˜¯åŸºäºGoè¯­è¨€å¼€å‘çš„å¼€æºåº”ç”¨å®¹å™¨å¼•æ“ï¼Œéµä»Apaâ€¦â€¦"><meta property="og:url" content="/python/92.docker%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF%E8%AF%A6%E8%A7%A3/"><meta property="og:site_name" content="Hanxin"><meta property="og:locale" content="zh"><meta property="og:image" content="/icons/apple-touch-icon.png"><meta property="og:type" content="website"></head><body><div class=container><header class=header><div class=header-wrapper><div class="header-inner single"><div class=site-brand><a href=/ class=brand>Hanxin</a></div><nav class=nav><ul class=menu id=menu><li class=menu-item><a href=/life/><span class=menu-item-name>ç”Ÿæ´»</span></a></li><li class=menu-item><a href=/tech/><span class=menu-item-name>æŠ€æœ¯</span></a></li><li class=menu-item><a href=/tags/><span class=menu-item-name>æ ‡ç­¾</span></a></li><li class=menu-item><a href=/about/><span class=menu-item-name>å…³äº</span></a></li><li class=menu-item><a href=/blogroll/><span class=menu-item-name>å‹é“¾</span></a></li><li class=menu-item><a href=/python/><span class=menu-item-name>Python-100å¤©</span></a></li><li class=menu-item><a id=theme-switcher href=#><span class="icon theme-icon-light">ğŸŒ</span><span class="icon theme-icon-dark">ğŸŒ™</span></a></li></ul></nav></div></div><input type=checkbox id=nav-toggle aria-hidden=true>
<label for=nav-toggle class=nav-toggle></label>
<label for=nav-toggle class=nav-curtain></label></header><main class="main single" id=main><div class=main-inner><article class="content post h-entry" data-align=justify data-type=python data-toc-num=true><h1 class="post-title p-name">92.Dockerå®¹å™¨æŠ€æœ¯è¯¦è§£</h1><div class=post-meta><time datetime=2021-08-23T17:33:56+08:00 class="post-meta-item published dt-published"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon post-meta-icon"><path d="M148 288h-40c-6.6.0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h40c6.6.0 12 5.4 12 12v40c0 6.6-5.4 12-12 12zm108-12v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm-96 96v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm-96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm192 0v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm96-260v352c0 26.5-21.5 48-48 48H48c-26.5.0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h48V12c0-6.6 5.4-12 12-12h40c6.6.0 12 5.4 12 12v52h128V12c0-6.6 5.4-12 12-12h40c6.6.0 12 5.4 12 12v52h48c26.5.0 48 21.5 48 48zm-48 346V160H48v298c0 3.3 2.7 6 6 6h340c3.3.0 6-2.7 6-6z"/></svg>&nbsp;2021.8.23</time>
<time datetime=2022-01-16T09:24:35+00:00 class="post-meta-item modified dt-updated"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon post-meta-icon"><path d="M4e2 64h-48V12c0-6.627-5.373-12-12-12h-40c-6.627.0-12 5.373-12 12v52H160V12c0-6.627-5.373-12-12-12h-40c-6.627.0-12 5.373-12 12v52H48C21.49 64 0 85.49.0 112v352c0 26.51 21.49 48 48 48h352c26.51.0 48-21.49 48-48V112c0-26.51-21.49-48-48-48zm-6 4e2H54a6 6 0 01-6-6V160h352v298a6 6 0 01-6 6zm-52.849-200.65L198.842 404.519c-4.705 4.667-12.303 4.637-16.971-.068l-75.091-75.699c-4.667-4.705-4.637-12.303.068-16.971l22.719-22.536c4.705-4.667 12.303-4.637 16.97.069l44.104 44.461 111.072-110.181c4.705-4.667 12.303-4.637 16.971.068l22.536 22.718c4.667 4.705 4.636 12.303-.069 16.97z"/></svg>&nbsp;2022.1.16</time>
<span class="post-meta-item wordcount"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon post-meta-icon"><path d="M497.9 142.1l-46.1 46.1c-4.7 4.7-12.3 4.7-17 0l-111-111c-4.7-4.7-4.7-12.3.0-17l46.1-46.1c18.7-18.7 49.1-18.7 67.9.0l60.1 60.1c18.8 18.7 18.8 49.1.0 67.9zM284.2 99.8 21.6 362.4.4 483.9c-2.9 16.4 11.4 30.6 27.8 27.8l121.5-21.3 262.6-262.6c4.7-4.7 4.7-12.3.0-17l-111-111c-4.8-4.7-12.4-4.7-17.1.0zM124.1 339.9c-5.5-5.5-5.5-14.3.0-19.8l154-154c5.5-5.5 14.3-5.5 19.8.0s5.5 14.3.0 19.8l-154 154c-5.5 5.5-14.3 5.5-19.8.0zM88 424h48v36.3l-64.5 11.3-31.1-31.1L51.7 376H88v48z"/></svg>&nbsp;9273</span>
<span class="post-meta-item reading-time"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon post-meta-icon"><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm0 448c-110.5.0-2e2-89.5-2e2-2e2S145.5 56 256 56s2e2 89.5 2e2 2e2-89.5 2e2-2e2 2e2zm61.8-104.4-84.9-61.7c-3.1-2.3-4.9-5.9-4.9-9.7V116c0-6.6 5.4-12 12-12h32c6.6.0 12 5.4 12 12v141.7l66.8 48.6c5.4 3.9 6.5 11.4 2.6 16.8L334.6 349c-3.9 5.3-11.4 6.5-16.8 2.6z"/></svg>&nbsp;19&nbsp;åˆ†é’Ÿ</span></div><div class="post-body e-content"><h2 id=dockerå®¹å™¨æŠ€æœ¯è¯¦è§£><a href=#dockerå®¹å™¨æŠ€æœ¯è¯¦è§£ class=anchor-link>#</a>Dockerå®¹å™¨æŠ€æœ¯è¯¦è§£</h2><p>Dockeræ˜¯åŸºäºGoè¯­è¨€å¼€å‘çš„å¼€æºåº”ç”¨å®¹å™¨å¼•æ“ï¼Œéµä»Apache Licence 2.0åè®®ï¼Œå¯ä»¥è®©å¼€å‘è€…æ‰“åŒ…åº”ç”¨ä»¥åŠåº”ç”¨çš„ä¾èµ–åŒ…åˆ°ä¸€ä¸ªå¯ç§»æ¤çš„å®¹å™¨ä¸­ï¼Œç„¶åå‘å¸ƒåˆ°å„ç§å‘è¡Œç‰ˆæœ¬çš„Linuxç³»ç»Ÿä¸Šã€‚</p><h3 id=dockerç®€ä»‹><a href=#dockerç®€ä»‹ class=anchor-link>#</a>Dockerç®€ä»‹</h3><p>è½¯ä»¶å¼€å‘ä¸­æœ€ä¸ºéº»çƒ¦çš„äº‹æƒ…å¯èƒ½å°±æ˜¯é…ç½®ç¯å¢ƒäº†ã€‚ç”±äºç”¨æˆ·ä½¿ç”¨çš„æ“ä½œç³»ç»Ÿå…·æœ‰å¤šæ ·æ€§ï¼Œå³ä¾¿ä½¿ç”¨è·¨å¹³å°çš„å¼€å‘è¯­è¨€ï¼ˆå¦‚Javaå’ŒPythonï¼‰éƒ½ä¸èƒ½ä¿è¯ä»£ç èƒ½å¤Ÿåœ¨å„ç§å¹³å°ä¸‹éƒ½å¯ä»¥æ­£å¸¸çš„è¿è½¬ï¼Œè€Œä¸”åœ¨ä¸åŒçš„ç¯å¢ƒä¸‹æˆ‘ä»¬å®‰è£…çš„è½¯ä»¶éœ€è¦ä¾èµ–çš„è½¯ä»¶åŒ…ä¹Ÿæ˜¯ä¸ä¸€æ ·çš„ã€‚</p><p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œæˆ‘ä»¬å®‰è£…è½¯ä»¶çš„æ—¶å€™å¯ä¸å¯ä»¥æŠŠè½¯ä»¶è¿è¡Œçš„ç¯å¢ƒä¸€å¹¶å®‰è£…ï¼Ÿæˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥æŠŠåŸå§‹ç¯å¢ƒä¸€æ¨¡ä¸€æ ·åœ°å¤åˆ¶è¿‡æ¥å‘¢ï¼Ÿ</p><p>è™šæ‹Ÿæœºï¼ˆvirtual machineï¼‰å°±æ˜¯å¸¦ç¯å¢ƒå®‰è£…çš„ä¸€ç§è§£å†³æ–¹æ¡ˆï¼Œå®ƒå¯ä»¥åœ¨ä¸€ç§æ“ä½œç³»ç»Ÿé‡Œé¢è¿è¡Œå¦ä¸€ç§æ“ä½œç³»ç»Ÿï¼Œæ¯”å¦‚åœ¨Windowsç³»ç»Ÿé‡Œé¢è¿è¡ŒLinuxç³»ç»Ÿï¼Œåœ¨macOSä¸Šè¿è¡ŒWindowsï¼Œè€Œåº”ç”¨ç¨‹åºå¯¹æ­¤æ¯«æ— æ„ŸçŸ¥ã€‚ä½¿ç”¨è¿‡è™šæ‹Ÿæœºçš„äººéƒ½çŸ¥é“ï¼Œè™šæ‹Ÿæœºç”¨èµ·æ¥è·ŸçœŸå®ç³»ç»Ÿä¸€æ¨¡ä¸€æ ·ï¼Œè€Œå¯¹äºè™šæ‹Ÿæœºçš„å®¿ä¸»ç³»ç»Ÿæ¥è¯´ï¼Œè™šæ‹Ÿæœºå°±æ˜¯ä¸€ä¸ªæ™®é€šæ–‡ä»¶ï¼Œä¸éœ€è¦äº†å°±åˆ æ‰ï¼Œå¯¹å®¿ä¸»ç³»ç»Ÿæˆ–è€…å…¶ä»–çš„ç¨‹åºå¹¶æ²¡æœ‰å½±å“ã€‚ä½†æ˜¯è™šæ‹Ÿæœºé€šå¸¸ä¼šå ç”¨è¾ƒå¤šçš„ç³»ç»Ÿèµ„æºï¼Œå¯åŠ¨å’Œå…³é—­ä¹Ÿéå¸¸çš„ç¼“æ…¢ï¼Œæ€»ä¹‹ç”¨æˆ·ä½“éªŒå¹¶æ²¡æœ‰æƒ³è±¡ä¸­çš„é‚£ä¹ˆå¥½ã€‚</p><p>Dockerå±äºå¯¹Linuxå®¹å™¨æŠ€æœ¯ï¼ˆLXCï¼‰çš„ä¸€ç§å°è£…ï¼ˆåˆ©ç”¨äº†Linuxçš„namespaceå’ŒcgroupæŠ€æœ¯ï¼‰ï¼Œå®ƒæä¾›äº†ç®€å•æ˜“ç”¨çš„å®¹å™¨ä½¿ç”¨æ¥å£ï¼Œæ˜¯ç›®å‰æœ€æµè¡Œçš„ Linux å®¹å™¨è§£å†³æ–¹æ¡ˆã€‚Dockerå°†åº”ç”¨ç¨‹åºä¸è¯¥ç¨‹åºçš„ä¾èµ–æ‰“åŒ…åœ¨ä¸€ä¸ªæ–‡ä»¶é‡Œé¢ï¼Œè¿è¡Œè¿™ä¸ªæ–‡ä»¶ï¼Œå°±ä¼šç”Ÿæˆä¸€ä¸ªè™šæ‹Ÿå®¹å™¨ã€‚ç¨‹åºåœ¨è¿™ä¸ªè™šæ‹Ÿå®¹å™¨é‡Œè¿è¡Œï¼Œå°±å¥½åƒåœ¨çœŸå®çš„ç‰©ç†æœºä¸Šè¿è¡Œä¸€æ ·ã€‚ä¸‹å›¾æ˜¯è™šæ‹Ÿæœºå’Œå®¹å™¨çš„å¯¹æ¯”ï¼Œå·¦è¾¹æ˜¯ä¼ ç»Ÿçš„è™šæ‹Ÿæœºï¼Œå³è¾¹æ˜¯Dockerã€‚</p><p><img src=/res/docker_vs_vm.png alt></p><p>ç›®å‰ï¼ŒDockerä¸»è¦ç”¨äºå‡ ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</p><ol><li>æä¾›ä¸€æ¬¡æ€§çš„ç¯å¢ƒã€‚</li><li>æä¾›å¼¹æ€§çš„äº‘æœåŠ¡ï¼ˆåˆ©ç”¨Dockerå¾ˆå®¹æ˜“å®ç°æ‰©å®¹å’Œæ”¶ç¼©ï¼‰ã€‚</li><li>å®è·µå¾®æœåŠ¡æ¶æ„ï¼ˆéš”ç¦»çœŸå®ç¯å¢ƒåœ¨å®¹å™¨ä¸­è¿è¡Œå¤šä¸ªæœåŠ¡ï¼‰ã€‚</li></ol><h3 id=å®‰è£…docker><a href=#å®‰è£…docker class=anchor-link>#</a>å®‰è£…Docker</h3><p>ä¸‹é¢ä»¥CentOSä¸ºä¾‹è®²è§£å¦‚ä½•å®‰è£…Dockerï¼Œä½¿ç”¨<a href=https://docs.docker.com/install/linux/docker-ce/ubuntu/ target=_blank rel=noopener>Ubuntu</a>ã€<a href=https://docs.docker.com/docker-for-mac/install/ target=_blank rel=noopener>macOS</a>æˆ–<a href=https://docs.docker.com/docker-for-windows/install/ target=_blank rel=noopener>Windows</a>çš„ç”¨æˆ·å¯ä»¥é€šè¿‡ç‚¹å‡»å¯¹åº”çš„é“¾æ¥äº†è§£è¿™äº›å¹³å°ä¸‹å¦‚ä½•è¿›è¡Œå®‰è£…ã€‚</p><ol><li><p>ç¡®å®šæ“ä½œç³»ç»Ÿå†…æ ¸ç‰ˆæœ¬ï¼ˆCentOS 7è¦æ±‚64ä½ï¼Œå†…æ ¸ç‰ˆæœ¬3.10+ï¼›CentOS 6è¦æ±‚64ä½ï¼Œå†…æ ¸ç‰ˆæœ¬2.6+ï¼‰ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash>uname -r
</code></pre></td></tr></table></div></div></div></li><li><p>æ›´æ–°ç³»ç»Ÿåº•å±‚çš„åº“æ–‡ä»¶ï¼ˆå»ºè®®ä¸€å®šè¦æ‰§è¡Œï¼Œå¦åˆ™åœ¨ä½¿ç”¨Dockeræ—¶å¯èƒ½ä¼šå‡ºç°è«åå…¶å¦™çš„é—®é¢˜ï¼‰ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash>yum update
</code></pre></td></tr></table></div></div></div></li><li><p>ç§»é™¤å¯èƒ½å­˜åœ¨çš„æ—§çš„Dockerç‰ˆæœ¬ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash>yum list installed <span class=p>|</span> grep docker
yum erase -y docker docker-common docker-engine
</code></pre></td></tr></table></div></div></div></li><li><p>å®‰è£…yumå·¥å…·åŒ…å’Œä¾èµ–é¡¹ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash>yum install -y yum-utils device-mapper-persistent-data lvm2
</code></pre></td></tr></table></div></div></div></li><li><p>é€šè¿‡yumå·¥å…·åŒ…æ·»åŠ yumæºï¼ˆå®‰è£…Docker-ceçš„æºï¼‰ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash>yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo
</code></pre></td></tr></table></div></div></div></li><li><p>åœ¨CentOSä¸‹ä½¿ç”¨yumå®‰è£…Docker-ceå¹¶å¯åŠ¨ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Bash data-lang=Bash>yum -y install docker-ce
systemctl start docker
</code></pre></td></tr></table></div></div></div></li><li><p>æŸ¥çœ‹Dockerçš„ä¿¡æ¯å’Œç‰ˆæœ¬ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>docker version
docker info
</code></pre></td></tr></table></div></div></div></li></ol><p>æ¥ä¸‹æ¥å¯ä»¥é€šè¿‡ä¸‹è½½é•œåƒå’Œåˆ›å»ºå®¹å™¨æ¥çœ‹çœ‹Dockeræ˜¯å¦å¯ä»¥è¿è½¬èµ·æ¥ã€‚å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ä»Dockerçš„é•œåƒä»“åº“ä¸‹è½½åä¸ºhello-worldçš„é•œåƒæ–‡ä»¶ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>docker pull hello-world
</code></pre></td></tr></table></div></div></div><p>æŸ¥çœ‹æ‰€æœ‰é•œåƒæ–‡ä»¶ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>docker images
</code></pre></td></tr></table></div></div></div><pre tabindex=0><code>REPOSITORY               TAG        IMAGE ID            CREATED             SIZE
docker.io/hello-world    latest     fce289e99eb9        7 months ago        1.84 kB
</code></pre><p>é€šè¿‡é•œåƒæ–‡ä»¶åˆ›å»ºå¹¶è¿è¡Œå®¹å™¨ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>docker container run --name mycontainer hello-world
</code></pre></td></tr></table></div></div></div><blockquote><p>è¯´æ˜ï¼šå…¶ä¸­<code>mycontainer</code>æ˜¯æˆ‘ä»¬ç»™å®¹å™¨èµ·çš„åå­—ï¼Œè·Ÿåœ¨<code>--name</code>å‚æ•°ä¹‹åï¼›<code>hello-world</code>å°±æ˜¯æˆ‘ä»¬åˆšæ‰ä¸‹è½½çš„é•œåƒæ–‡ä»¶ã€‚</p></blockquote><pre tabindex=0><code>Hello from Docker!
This message shows that your installation appears to be working correctly.

To generate this message, Docker took the following steps:
 1. The Docker client contacted the Docker daemon.
 2. The Docker daemon pulled the &quot;hello-world&quot; image from the Docker Hub.
    (amd64)
 3. The Docker daemon created a new container from that image which runs the
    executable that produces the output you are currently reading.
 4. The Docker daemon streamed that output to the Docker client, which sent it
    to your terminal.

To try something more ambitious, you can run an Ubuntu container with:
 $ docker run -it ubuntu bash

Share images, automate workflows, and more with a free Docker ID:
 https://hub.docker.com/

For more examples and ideas, visit:
 https://docs.docker.com/get-started/
</code></pre><p>å¦‚æœè¦åˆ é™¤è¿™ä¸ªå®¹å™¨ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>docker container rm mycontainer
</code></pre></td></tr></table></div></div></div><p>åœ¨åˆ é™¤å®¹å™¨ä¹‹åï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åˆ é™¤åˆšæ‰ä¸‹è½½çš„é•œåƒæ–‡ä»¶ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>docker rmi hello-world
</code></pre></td></tr></table></div></div></div><blockquote><p>è¯´æ˜ï¼šå¦‚æœè¦åœ¨Ubuntuï¼ˆå†…æ ¸ç‰ˆæœ¬3.10+ï¼‰ä¸‹é¢å®‰è£…å’Œå¯åŠ¨Dockerï¼Œå¯ä»¥æŒ‰ç…§å¦‚ä¸‹çš„æ­¥éª¤è¿›è¡Œã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>apt update
apt install docker-ce
service docker start
</code></pre></td></tr></table></div></div></div><p>å›½å†…ç”¨æˆ·å¯ä»¥é€šè¿‡æ›´æ¢Ubuntuè½¯ä»¶ä¸‹è½½æºæ¥æå‡ä¸‹è½½é€Ÿåº¦ï¼Œå…·ä½“è¯·å‚ç…§æ¸…åå¤§å­¦å¼€æºè½¯ä»¶é•œåƒç«™ä¸Šçš„<a href=https://mirrors.tuna.tsinghua.edu.cn/help/ubuntu/ target=_blank rel=noopener>ã€ŠUbuntué•œåƒä½¿ç”¨å¸®åŠ©ã€‹</a>ã€‚</p></blockquote><p>å®‰è£…Dockeråï¼Œç”±äºç›´æ¥è®¿é—®<a href=https://hub.docker.com/ target=_blank rel=noopener>dockerhub</a>ä¸‹è½½é•œåƒä¼šéå¸¸ç¼“æ…¢ï¼Œå»ºè®®å°†æœåŠ¡å™¨æ›´æ¢ä¸ºå›½å†…é•œåƒï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹ <code>/etc/docker/daemon.json</code> æ–‡ä»¶æ¥åšåˆ°ã€‚ä¸€èˆ¬çš„äº‘æœåŠ¡å™¨ä¼šæœ‰è‡ªå·±ä¸“å±çš„é•œåƒï¼Œå°±ä¸éœ€è¦æ‰‹åŠ¨ä¿®æ”¹äº†ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-JavaScript data-lang=JavaScript><span class=p>{</span>
	<span class=s2>&#34;registry-mirrors&#34;</span><span class=o>:</span> <span class=p>[</span>
        <span class=s2>&#34;http://hub-mirror.c.163.com&#34;</span><span class=p>,</span>
        <span class=s2>&#34;https://registry.docker-cn.com&#34;</span>
    <span class=p>]</span>
<span class=p>}</span>
</code></pre></td></tr></table></div></div></div><h3 id=ä½¿ç”¨docker><a href=#ä½¿ç”¨docker class=anchor-link>#</a>ä½¿ç”¨Docker</h3><p>æƒ³è¦ç©è½¬Dockerï¼Œæœ€ç®€å•çš„åŠæ³•å°±æ˜¯é©¬ä¸Šç”¨Dockeråˆ›å»ºä¸€äº›è‡ªå·±å­¦ä¹ å’Œå·¥ä½œä¸­éœ€è¦ç”¨åˆ°çš„å®¹å™¨ï¼Œä¸‹é¢æˆ‘ä»¬å¸¦ç€å¤§å®¶ä¸€èµ·æ¥åˆ›å»ºè¿™äº›å®¹å™¨ã€‚</p><h4 id=è¿è¡Œnginx><a href=#è¿è¡Œnginx class=anchor-link>#</a>è¿è¡ŒNginx</h4><p>Nginxæ˜¯é«˜æ€§èƒ½çš„WebæœåŠ¡å™¨ï¼ŒåŒæ—¶ä¹Ÿæ˜¯åšåå‘ä»£ç†æœåŠ¡å™¨çš„ä¸Šä½³é€‰æ‹©ã€‚ä½¿ç”¨Dockerå¯ä»¥éå¸¸ç®€å•çš„åˆ›å»ºä¸€ä¸ªè¿è¡ŒNginxçš„å®¹å™¨ï¼Œå‘½ä»¤å¦‚ä¸‹æ‰€ç¤ºã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>docker container run -d -p 80:80 --rm --name mynginx nginx
</code></pre></td></tr></table></div></div></div><blockquote><p>è¯´æ˜ï¼šä¸Šé¢çš„å‚æ•°<code>-d</code>è¡¨ç¤ºå®¹å™¨åœ¨åå°è¿è¡Œï¼ˆä¸äº§ç”Ÿè¾“å‡ºåˆ°Shellï¼‰å¹¶æ˜¾ç¤ºå®¹å™¨çš„IDï¼›<code>-p</code>æ˜¯ç”¨æ¥æ˜ å°„å®¹å™¨çš„ç«¯å£åˆ°å®¿ä¸»æœºçš„ç«¯å£ï¼Œå†’å·å‰é¢æ˜¯å®¿ä¸»æœºçš„ç«¯å£ï¼Œå†’å·åé¢æ˜¯å®¹å™¨å†…éƒ¨ä½¿ç”¨çš„ç«¯å£ï¼›<code>--rm</code>è¡¨ç¤ºå®¹å™¨åœæ­¢åè‡ªåŠ¨åˆ é™¤å®¹å™¨ï¼Œä¾‹å¦‚æ‰§è¡Œå‘½ä»¤<code>docker container stop mynginx</code>åï¼Œå®¹å™¨å°±ä¸å¤å­˜åœ¨äº†ï¼›<code>--name</code>åé¢çš„mynginxæ˜¯è‡ªå®šä¹‰çš„å®¹å™¨åå­—ï¼›åœ¨åˆ›å»ºå®¹å™¨çš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦ç”¨åˆ°nginxçš„é•œåƒæ–‡ä»¶ï¼Œé•œåƒæ–‡ä»¶çš„ä¸‹è½½æ˜¯è‡ªåŠ¨å®Œæˆçš„ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šç‰ˆæœ¬å·ï¼Œé»˜è®¤æ˜¯æœ€æ–°ç‰ˆæœ¬ï¼ˆlatestï¼‰ã€‚</p></blockquote><p>å¦‚æœéœ€è¦å°†è‡ªå·±çš„Webé¡¹ç›®ï¼ˆé¡µé¢ï¼‰éƒ¨ç½²åˆ°Nginxä¸Šï¼Œå¯ä»¥ä½¿ç”¨å®¹å™¨æ‹·è´å‘½ä»¤å°†æŒ‡å®šè·¯å¾„ä¸‹æ‰€æœ‰çš„æ–‡ä»¶å’Œæ–‡ä»¶å¤¹æ‹·è´åˆ°å®¹å™¨çš„æŒ‡å®šç›®å½•ä¸­ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>docker container cp /root/web/index.html mynginx:/usr/share/nginx/html
</code></pre></td></tr></table></div></div></div><p>å¦‚æœä¸æ„¿æ„æ‹·è´æ–‡ä»¶ä¹Ÿå¯ä»¥åœ¨åˆ›å»ºå®¹å™¨æ—¶é€šè¿‡æ•°æ®å·æ“ä½œ<code>--volume</code>å°†æŒ‡å®šçš„æ–‡ä»¶å¤¹æ˜ å°„åˆ°å®¹å™¨çš„æŸä¸ªç›®å½•ä¸­ï¼Œä¾‹å¦‚å°†Webé¡¹ç›®çš„æ–‡ä»¶å¤¹ç›´æ¥æ˜ å°„åˆ°<code>/usr/share/nginx/html</code>ç›®å½•ã€‚æˆ‘ä»¬å…ˆé€šè¿‡ä¸‹é¢çš„å‘½ä»¤è®©åˆšæ‰åˆ›å»ºçš„å®¹å™¨åœæ­¢è¿è¡Œã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>docker container stop mynginx
</code></pre></td></tr></table></div></div></div><p>ç„¶åç”¨ä¸‹é¢çš„å‘½ä»¤é‡æ–°åˆ›å»ºå®¹å™¨ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>docker container run -d -p 80:80 --rm --name mynginx --volume /root/docker/nginx/html:/usr/share/nginx/html nginx
</code></pre></td></tr></table></div></div></div><blockquote><p>è¯´æ˜ï¼šä¸Šé¢åˆ›å»ºå®¹å™¨å’Œæ‹·è´æ–‡ä»¶çš„å‘½ä»¤ä¸­ï¼Œ<code>container</code>æ˜¯å¯ä»¥çœç•¥çš„ï¼Œä¹Ÿå°±æ˜¯è¯´<code>docker container run</code>å’Œ<code>docker run</code>æ˜¯ä¸€æ ·çš„ï¼Œè€Œ<code>docker container cp</code>å’Œ<code>docker cp</code>æ˜¯ä¸€æ ·çš„ã€‚æ­¤å¤–ï¼Œå‘½ä»¤ä¸­çš„<code>--volume</code>ä¹Ÿå¯ä»¥ç¼©å†™ä¸º<code>-v</code>ï¼Œå°±å¦‚åŒ<code>-d</code>æ˜¯<code>--detach</code>çš„ç¼©å†™ï¼Œ<code>-p</code>æ˜¯<code>--publish</code>çš„ç¼©å†™ã€‚<code>$PWD</code>ä»£è¡¨å®¿ä¸»ç³»ç»Ÿå½“å‰æ–‡ä»¶å¤¹ï¼Œè¿™äº›å¯¹äºä½¿ç”¨è¿‡Unixæˆ–è€…Linuxç³»ç»Ÿçš„äººæ¥è¯´ï¼Œåº”è¯¥æ˜¯å¾ˆå®¹æ˜“ç†è§£çš„ã€‚</p></blockquote><p>è¦æŸ¥çœ‹è¿è¡Œä¸­çš„å®¹å™¨ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>docker ps
</code></pre></td></tr></table></div></div></div><pre tabindex=0><code>CONTAINER ID    IMAGE    COMMAND                  CREATED            STATUS             PORTS                 NAMES
3c38d2476384    nginx    &quot;nginx -g 'daemon ...&quot;   4 seconds ago      Up 4 seconds       0.0.0.0:80-&gt;80/tcp    mynginx
</code></pre><p>è¦å¯åŠ¨å’Œåœæ­¢å®¹å™¨ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>docker start mynginx
docker stop mynginx
</code></pre></td></tr></table></div></div></div><p>ç”±äºåœ¨åˆ›å»ºå®¹å™¨æ—¶ä½¿ç”¨äº†<code>--rm</code>é€‰é¡¹ï¼Œå®¹å™¨åœ¨åœæ­¢æ—¶ä¼šè¢«ç§»é™¤ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤æŸ¥çœ‹æ‰€æœ‰å®¹å™¨æ—¶ï¼Œåº”è¯¥å·²ç»çœ‹ä¸åˆ°åˆšæ‰çš„<code>mynginx</code>å®¹å™¨äº†ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>docker container ls -a
</code></pre></td></tr></table></div></div></div><p>å¦‚æœåœ¨åˆ›å»ºå®¹å™¨æ—¶æ²¡æœ‰æŒ‡å®š<code>--rm</code>é€‰é¡¹ï¼Œé‚£ä¹ˆä¹Ÿå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤æ¥åˆ é™¤å®¹å™¨ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>docker rm mynginx
</code></pre></td></tr></table></div></div></div><p>è¦åˆ é™¤æ­£åœ¨è¿è¡Œä¸­çš„å®¹å™¨ï¼Œéœ€è¦ä½¿ç”¨<code>-f</code>é€‰é¡¹ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>docker rm -f mynginx
</code></pre></td></tr></table></div></div></div><h4 id=è¿è¡Œmysql><a href=#è¿è¡Œmysql class=anchor-link>#</a>è¿è¡ŒMySQL</h4><p>æˆ‘ä»¬å†æ¥å°è¯•ç”¨Dockerå®‰è£…ä¸€å°MySQLæœåŠ¡å™¨ï¼Œé¦–å…ˆå¯ä»¥å…ˆæ£€æŸ¥ä¸€ä¸‹æœ‰æ²¡æœ‰MySQLçš„é•œåƒæ–‡ä»¶ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>docker search mysql
</code></pre></td></tr></table></div></div></div><pre tabindex=0><code>INDEX        NAME            DESCRIPTION        STARS        OFFICIAL        AUTOMATED
docker.io    docker.io/mysql MySQL is a ...     8486         [OK]
...
</code></pre><blockquote><p>è¯´æ˜ï¼šä¸Šé¢æŸ¥è¯¢ç»“æœçš„åˆ—ä¾æ¬¡ä»£è¡¨ç´¢å¼•ã€é•œåƒåã€é•œåƒæè¿°ã€ç”¨æˆ·è¯„ä»·ã€æ˜¯å¦å®˜æ–¹é•œåƒã€è‡ªåŠ¨æ„å»ºã€‚</p></blockquote><p>ä¸‹è½½MySQLé•œåƒå¹¶æŒ‡å®šé•œåƒçš„ç‰ˆæœ¬å·ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>docker pull mysql:5.7
</code></pre></td></tr></table></div></div></div><p>å¦‚æœéœ€è¦æŸ¥çœ‹å·²ç»ä¸‹è½½çš„é•œåƒæ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>docker images
</code></pre></td></tr></table></div></div></div><pre tabindex=0><code>REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
docker.io/nginx     latest              e445ab08b2be        2 weeks ago         126 MB
docker.io/mysql     5.7                 f6509bac4980        3 weeks ago         373 MB
</code></pre><p>åˆ›å»ºå¹¶è¿è¡ŒMySQLå®¹å™¨ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>docker run -d -p 3306:3306 --name mysql57 -v /root/docker/mysql/conf:/etc/mysql/mysql.conf.d -v /root/docker/mysql/data:/var/lib/mysql -e <span class=nv>MYSQL_ROOT_PASSWORD</span><span class=o>=</span><span class=m>123456</span> mysql:5.7
</code></pre></td></tr></table></div></div></div><blockquote><p><strong>æ³¨æ„</strong>ï¼šä¸Šé¢åˆ›å»ºå®¹å™¨æ—¶æˆ‘ä»¬åˆä¸€æ¬¡ä½¿ç”¨äº†æ•°æ®å·æ“ä½œï¼Œé‚£æ˜¯å› ä¸ºé€šå¸¸å®¹å™¨æ˜¯éšæ—¶åˆ›å»ºéšæ—¶åˆ é™¤çš„ï¼Œè€Œæ•°æ®åº“ä¸­çš„æ•°æ®å´æ˜¯éœ€è¦ä¿ç•™ä¸‹æ¥çš„ã€‚</p></blockquote><p>ä¸Šé¢çš„ä¸¤ä¸ªæ•°æ®å·æ“ä½œä¸€ä¸ªæ˜¯æ˜ å°„äº†MySQLé…ç½®æ–‡ä»¶æ‰€åœ¨çš„æ–‡ä»¶å¤¹ï¼Œä¸€ä¸ªæ˜¯æ˜ å°„äº†MySQLæ•°æ®æ‰€åœ¨çš„æ–‡ä»¶å¤¹ï¼Œè¿™ä¸¤ä¸ªæ•°æ®å·æ“ä½œéå¸¸é‡è¦ã€‚æˆ‘ä»¬å¯ä»¥å°†MySQLçš„é…ç½®æ–‡ä»¶æ”¾åœ¨<code>$PWD/mysql/conf</code>ç›®å½•ä¸‹ï¼Œé…ç½®æ–‡ä»¶çš„å…·ä½“å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-INI data-lang=INI><span class=k>[mysqld]</span>
<span class=na>pid-file</span><span class=o>=</span><span class=s>/var/run/mysqld/mysqld.pid</span>
<span class=na>socket</span><span class=o>=</span><span class=s>/var/run/mysqld/mysqld.sock</span>
<span class=na>datadir</span><span class=o>=</span><span class=s>/var/lib/mysql</span>
<span class=na>log-error</span><span class=o>=</span><span class=s>/var/log/mysql/error.log</span>
<span class=na>server-id</span><span class=o>=</span><span class=s>1</span>
<span class=na>log-bin</span><span class=o>=</span><span class=s>/var/log/mysql/mysql-bin.log</span>
<span class=na>expire_logs_days</span><span class=o>=</span><span class=s>30</span>
<span class=na>max_binlog_size</span><span class=o>=</span><span class=s>256M</span>
<span class=na>symbolic-links</span><span class=o>=</span><span class=s>0</span>
</code></pre></td></tr></table></div></div></div><p>å¦‚æœå®‰è£…äº†MySQL 8.xç‰ˆæœ¬ï¼ˆç›®å‰çš„æœ€æ–°ç‰ˆæœ¬ï¼‰ï¼Œåœ¨ä½¿ç”¨å®¢æˆ·ç«¯å·¥å…·è¿æ¥æœåŠ¡å™¨æ—¶å¯èƒ½ä¼šé‡åˆ°<code>error 2059: Authentication plugin 'caching_sha2_password' cannot be loaded</code>çš„é—®é¢˜ï¼Œè¿™æ˜¯å› ä¸ºMySQL 8.xé»˜è®¤ä½¿ç”¨äº†åä¸ºâ€œcaching_sha2_passwordâ€çš„æœºåˆ¶å¯¹ç”¨æˆ·å£ä»¤è¿›è¡Œäº†æ›´å¥½çš„ä¿æŠ¤ï¼Œä½†æ˜¯å¦‚æœå®¢æˆ·ç«¯å·¥å…·ä¸æ”¯æŒæ–°çš„è®¤è¯æ–¹å¼ï¼Œè¿æ¥å°±ä¼šå¤±è´¥ã€‚è§£å†³è¿™ä¸ªé—®é¢˜æœ‰ä¸¤ç§æ–¹å¼ï¼šä¸€æ˜¯å‡çº§å®¢æˆ·ç«¯å·¥å…·æ¥æ”¯æŒMySQL 8.xçš„è®¤è¯æ–¹å¼ï¼›äºŒæ˜¯è¿›å…¥å®¹å™¨ï¼Œä¿®æ”¹MySQLçš„ç”¨æˆ·å£ä»¤è®¤è¯æ–¹å¼ã€‚ä¸‹é¢æ˜¯å…·ä½“çš„æ­¥éª¤ï¼Œæˆ‘ä»¬å…ˆç”¨<code>docker exec</code>å‘½ä»¤è¿›å…¥å®¹å™¨çš„äº¤äº’å¼ç¯å¢ƒï¼Œå‡è®¾è¿è¡ŒMySQL 8.xçš„å®¹å™¨åå­—å«<code>mysql8x</code>ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>docker <span class=nb>exec</span> -it mysql8x /bin/bash
</code></pre></td></tr></table></div></div></div><p>è¿›å…¥å®¹å™¨çš„äº¤äº’å¼Shellä¹‹åï¼Œå¯ä»¥é¦–å…ˆåˆ©ç”¨MySQLçš„å®¢æˆ·ç«¯å·¥å…·è¿æ¥MySQLæœåŠ¡å™¨ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>mysql -u root -p
Enter password:
Your MySQL connection id is <span class=m>16</span>
Server version: 8.0.12 MySQL Community Server - GPL
Copyright <span class=o>(</span>c<span class=o>)</span> 2000, 2018, Oracle and/or its affiliates. All rights reserved.
Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.
Type <span class=s1>&#39;help;&#39;</span> or <span class=s1>&#39;\h&#39;</span> <span class=k>for</span> help. Type <span class=s1>&#39;\c&#39;</span> to clear the current input statement.
mysql&gt;
</code></pre></td></tr></table></div></div></div><p>æ¥ä¸‹æ¥é€šè¿‡SQLæ¥ä¿®æ”¹ç”¨æˆ·å£ä»¤å°±å¯ä»¥äº†ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-SQL data-lang=SQL><span class=k>alter</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=s1>&#39;root&#39;</span><span class=o>@</span><span class=s1>&#39;%&#39;</span><span class=w> </span><span class=n>identified</span><span class=w> </span><span class=k>with</span><span class=w> </span><span class=n>mysql_native_password</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=s1>&#39;123456&#39;</span><span class=w> </span><span class=n>password</span><span class=w> </span><span class=n>expire</span><span class=w> </span><span class=n>never</span><span class=p>;</span><span class=w>
</span></code></pre></td></tr></table></div></div></div><p>å½“ç„¶ï¼Œå¦‚æœæ„¿æ„ä½ ä¹Ÿå¯ä»¥æŸ¥çœ‹ä¸€ä¸‹ç”¨æˆ·è¡¨æ£€æŸ¥æ˜¯å¦ä¿®æ”¹æˆåŠŸã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-SQL data-lang=SQL><span class=n>use</span><span class=w> </span><span class=n>mysql</span><span class=p>;</span><span class=w>
</span><span class=w></span><span class=k>select</span><span class=w> </span><span class=k>user</span><span class=p>,</span><span class=w> </span><span class=k>host</span><span class=p>,</span><span class=w> </span><span class=n>plugin</span><span class=p>,</span><span class=w> </span><span class=n>authentication_string</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=k>user</span><span class=o>=</span><span class=s1>&#39;root&#39;</span><span class=p>;</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+-----------+-----------------------+-------------------------------------------+
</span><span class=c1></span><span class=o>|</span><span class=w> </span><span class=k>user</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>host</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=n>plugin</span><span class=w>                </span><span class=o>|</span><span class=w> </span><span class=n>authentication_string</span><span class=w>                     </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+-----------+-----------------------+-------------------------------------------+
</span><span class=c1></span><span class=o>|</span><span class=w> </span><span class=n>root</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=o>%</span><span class=w>         </span><span class=o>|</span><span class=w> </span><span class=n>mysql_native_password</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=o>*</span><span class=mi>6</span><span class=n>BB4837EB74329105EE4568DDA7DC67ED2CA2AD9</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>|</span><span class=w> </span><span class=n>root</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>localhost</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>mysql_native_password</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=o>*</span><span class=mi>6</span><span class=n>BB4837EB74329105EE4568DDA7DC67ED2CA2AD9</span><span class=w> </span><span class=o>|</span><span class=w>
</span><span class=w></span><span class=o>+</span><span class=c1>------+-----------+-----------------------+-------------------------------------------+
</span><span class=c1></span><span class=mi>2</span><span class=w> </span><span class=k>rows</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=k>set</span><span class=w> </span><span class=p>(</span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span><span class=w> </span><span class=n>sec</span><span class=p>)</span><span class=w>
</span></code></pre></td></tr></table></div></div></div><p>åœ¨å®Œæˆä¸Šé¢çš„æ­¥éª¤åï¼Œç°åœ¨å³ä¾¿ä¸æ›´æ–°å®¢æˆ·ç«¯å·¥å…·ä¹Ÿå¯ä»¥è¿æ¥MySQL 8.xäº†ã€‚</p><h4 id=è¿è¡Œredis><a href=#è¿è¡Œredis class=anchor-link>#</a>è¿è¡ŒRedis</h4><p>æ¥ä¸‹æ¥æˆ‘ä»¬è¯•ä¸€è¯•è¿è¡Œå¤šä¸ªå®¹å™¨å¹¶è®©å¤šä¸ªå®¹å™¨ä¹‹é—´é€šè¿‡ç½‘ç»œé€šä¿¡ã€‚æˆ‘ä»¬åˆ›å»º4ä¸ªRediså®¹å™¨æ¥å®ç°ä¸€ä¸»ä¸‰ä»çš„ä¸»ä»å¤åˆ¶ç»“æ„ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>docker run -d -p 6379:6379 --name redis-master redis
docker run -d -p 6380:6379 --name redis-slave-1 --link redis-master:redis-master redis redis-server --replicaof redis-master <span class=m>6379</span>
docker run -d -p 6381:6379 --name redis-slave-2 --link redis-master:redis-master redis redis-server --replicaof redis-master <span class=m>6379</span>
docker run -d -p 6382:6379 --name redis-slave-3 --link redis-master:redis-master redis redis-server --replicaof redis-master <span class=m>6379</span>
</code></pre></td></tr></table></div></div></div><p>ä¸Šé¢çš„å‘½ä»¤ä¸­ï¼Œ<code>--link</code>å‚æ•°ç”¨äºç»™å®¹å™¨åˆ›å»ºç½‘ç»œåˆ«åï¼Œå› ä¸ºä¸‰å°ä»æœºï¼ˆslaveï¼‰éœ€è¦é€šè¿‡ç½‘ç»œè¿æ¥è‡ªå·±çš„ä¸»æœºï¼ˆmasterï¼‰ã€‚è™½ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡<code>docker inspect --format '{{ .NetworkSettings.IPAddress }}' &lt;container-ID></code>å‘½ä»¤æ¥æŸ¥çœ‹åˆ°å®¹å™¨çš„IPåœ°å€ï¼Œä½†æ˜¯ç”±äºå®¹å™¨çš„å³è£…å³ç”¨æ€§ï¼Œå®¹å™¨çš„IPåœ°å€æœ‰å¯èƒ½ä¼šå‘ç”Ÿå˜åŒ–ï¼Œå¦‚æœç›´æ¥ä½¿ç”¨IPåœ°å€ï¼Œåœ¨å®¹å™¨é‡å¯åå°±å¯èƒ½ä¼šå› ä¸ºIPåœ°å€çš„å˜åŒ–å¯¼è‡´ä»æœºæ— æ³•è¿æ¥åˆ°ä¸»æœºã€‚ä½¿ç”¨<code>--link</code>å‚æ•°åˆ›å»ºç½‘ç»œåˆ«åå°±æ˜¯ä¸ºäº†åœ¨å¯åŠ¨RedisæœåŠ¡å™¨æ—¶åœ¨<code>redis-server</code>åé¢çš„<code>--replicaof</code>å‚æ•°åä½¿ç”¨è¿™ä¸ªåˆ«åè€Œä¸æ˜¯IPåœ°å€ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬è¿›å…¥åä¸º<code>redis-master</code>çš„å®¹å™¨ï¼Œçœ‹çœ‹ä¸»ä»å¤åˆ¶çš„é…ç½®æ˜¯å¦æˆåŠŸã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>docker <span class=nb>exec</span> -it redis-master /bin/bash
</code></pre></td></tr></table></div></div></div><p>é€šè¿‡<code>redis-cli</code>å¯åŠ¨å‘½ä»¤è¡Œå·¥å…·ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>redis-cli
127.0.0.1:6379&gt; info replication
<span class=c1># Replication</span>
role:master
connected_slaves:3
slave0:ip<span class=o>=</span>172.17.0.4,port<span class=o>=</span>6379,state<span class=o>=</span>online,offset<span class=o>=</span>1988,lag<span class=o>=</span><span class=m>0</span>
slave1:ip<span class=o>=</span>172.17.0.5,port<span class=o>=</span>6379,state<span class=o>=</span>online,offset<span class=o>=</span>1988,lag<span class=o>=</span><span class=m>1</span>
slave2:ip<span class=o>=</span>172.17.0.6,port<span class=o>=</span>6379,state<span class=o>=</span>online,offset<span class=o>=</span>1988,lag<span class=o>=</span><span class=m>1</span>
master_replid:94703cfa03c3ddc7decc74ca5b8dd13cb8b113ea
master_replid2:0000000000000000000000000000000000000000
master_repl_offset:1988
second_repl_offset:-1
repl_backlog_active:1
repl_backlog_size:1048576
repl_backlog_first_byte_offset:1
repl_backlog_histlen:1988
</code></pre></td></tr></table></div></div></div><h4 id=è¿è¡Œgitlab><a href=#è¿è¡Œgitlab class=anchor-link>#</a>è¿è¡ŒGitLab</h4><p>GitLabæ˜¯ç”±GitLab Inc.å¼€å‘çš„Gitä»“åº“ç®¡ç†å·¥å…·ï¼Œå…·æœ‰wikiã€é—®é¢˜è·Ÿè¸ªã€æŒç»­é›†æˆç­‰ä¸€ç³»åˆ—çš„åŠŸèƒ½ï¼Œåˆ†ä¸ºç¤¾åŒºç‰ˆå’Œä¼ä¸šç‰ˆã€‚é€šè¿‡Dockeræä¾›çš„è™šæ‹ŸåŒ–å®¹å™¨ï¼Œæˆ‘ä»¬å¯ä»¥å®‰è£…ç¤¾åŒºç‰ˆçš„Dockerã€‚å› ä¸ºGitLabéœ€è¦ä½¿ç”¨SSHåè®®è¿›è¡Œå®‰å…¨è¿æ¥ï¼Œæˆ‘ä»¬è¦æš´éœ²å®¹å™¨çš„22ç«¯å£ï¼Œæ‰€ä»¥å¯ä»¥å…ˆå°†å®¿ä¸»æœºSSHè¿æ¥çš„22ç«¯å£ä¿®æ”¹ä¸ºå…¶ä»–ç«¯å£ï¼ˆå¦‚ï¼š12345ï¼‰ï¼Œç„¶åå†è¿›è¡Œåç»­çš„æ“ä½œã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>vim /etc/ssh/sshd_config
</code></pre></td></tr></table></div></div></div><p>å°†å…¶ä¸­å®šä¹‰ç«¯å£çš„é‚£è¡Œä»£ç å»æ‰æ³¨é‡Šå¹¶å°†ç«¯å£ä¿®æ”¹ä¸º12345ã€‚</p><pre tabindex=0><code>Port 12345
</code></pre><p>é‡æ–°å¯åŠ¨<code>sshd</code>æœåŠ¡ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>systemctl restart sshd
</code></pre></td></tr></table></div></div></div><blockquote><p><strong>æç¤º</strong>ï¼šä¿®æ”¹ç«¯å£ååº”è¯¥ç¡®ä¿é˜²ç«å¢™ä¸Šä¹Ÿå¼€å¯å¯¹åº”çš„ç«¯å£ï¼Œå¦åˆ™æ— æ³•ä½¿ç”¨SSHè¿æ¥åˆ°LinuxæœåŠ¡å™¨ã€‚</p></blockquote><p>åˆ›å»ºéœ€è¦ç”¨äºæ•°æ®å·æ˜ å°„æ“ä½œçš„æ–‡ä»¶å¤¹ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>mkdir -p /root/gitlab/<span class=o>{</span>config,logs,data<span class=o>}</span>
</code></pre></td></tr></table></div></div></div><p>åŸºäº<code>gitlab/gitlab-ce</code>é•œåƒåˆ›å»ºå®¹å™¨ï¼Œå¹¶æš´éœ²80ç«¯å£ï¼ˆHTTPè¿æ¥ï¼‰å’Œ22ç«¯å£ï¼ˆSSHè¿æ¥ï¼‰ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>docker run -d -p 80:80 -p 22:22 --name gitlab -v /root/gitlab/config:/etc/gitlab -v /root/gitlab/logs:/var/log/gitlab -v /root/gitlab/data:/var/opt/gitlab gitlab/gitlab-ce
</code></pre></td></tr></table></div></div></div><blockquote><p>è¯´æ˜ï¼šGitLabçš„å¯åŠ¨æ¯”è¾ƒç¼“æ…¢ï¼Œåˆ›å»ºå¥½å®¹å™¨åå¯èƒ½éœ€è¦ç­‰å¾…ä¸€æ®µæ—¶é—´æ‰èƒ½é€šè¿‡æµè§ˆå™¨æ¥è¿›è¡Œè®¿é—®ã€‚</p></blockquote><p>é¦–æ¬¡è¿›å…¥GitLabè®¿é—®ç•Œé¢ä¼šæç¤ºæˆ‘ä»¬ä¿®æ”¹ç®¡ç†å‘˜å¯†ç ï¼Œè®¾ç½®å¥½ç®¡ç†å‘˜å¯†ç åå°±å¯ä»¥åœ¨ç™»å½•ç•Œé¢è¾“å…¥ç”¨æˆ·å<code>root</code>å’Œåˆšæ‰è®¾ç½®çš„å¯†ç ç™»å½•åˆ°ç®¡ç†å‘˜æ§åˆ¶å°ï¼Œåœ¨ä½¿ç”¨ä¸Šè¿˜æ˜¯éå¸¸ç®€å•å’Œäººæ€§åŒ–çš„ã€‚</p><h3 id=æ„å»ºé•œåƒ><a href=#æ„å»ºé•œåƒ class=anchor-link>#</a>æ„å»ºé•œåƒ</h3><p>é€šè¿‡ä¸Šé¢çš„è®²è§£ï¼Œæˆ‘ä»¬å·²ç»æŒæ¡äº†å¦‚ä½•é€šè¿‡å®˜æ–¹æä¾›çš„é•œåƒæ¥åˆ›å»ºå®¹å™¨ã€‚å½“ç„¶å¦‚æœæ„¿æ„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨é…ç½®å¥½çš„å®¹å™¨æ¥ç”Ÿæˆé•œåƒã€‚ç®€è€Œè¨€ä¹‹ï¼Œ<strong>Dockeré•œåƒæ˜¯ç”±æ–‡ä»¶ç³»ç»Ÿå åŠ è€Œæˆçš„ï¼Œç³»ç»Ÿçš„æœ€åº•å±‚æ˜¯bootfsï¼Œç›¸å½“äºå°±æ˜¯Linuxå†…æ ¸çš„å¼•å¯¼æ–‡ä»¶ç³»ç»Ÿï¼›æ¥ä¸‹æ¥ç¬¬äºŒå±‚æ˜¯rootfsï¼Œè¿™ä¸€å±‚å¯ä»¥æ˜¯ä¸€ç§æˆ–å¤šç§æ“ä½œç³»ç»Ÿï¼ˆå¦‚Debianæˆ–Ubuntuæ–‡ä»¶ç³»ç»Ÿï¼‰ï¼ŒDockerä¸­çš„rootfsæ˜¯åªè¯»çŠ¶æ€çš„ï¼›Dockeråˆ©ç”¨è”åˆæŒ‚è½½æŠ€æœ¯å°†å„å±‚æ–‡ä»¶ç³»ç»Ÿå åŠ åˆ°ä¸€èµ·ï¼Œæœ€ç»ˆçš„æ–‡ä»¶ç³»ç»Ÿä¼šåŒ…å«æœ‰åº•å±‚çš„æ–‡ä»¶å’Œç›®å½•ï¼Œè¿™æ ·çš„æ–‡ä»¶ç³»ç»Ÿå°±æ˜¯ä¸€ä¸ªé•œåƒ</strong>ã€‚</p><p>ä¹‹å‰æˆ‘ä»¬è®²è¿‡äº†å¦‚ä½•æŸ¥æ‰¾ã€åˆ—å‡ºé•œåƒå’Œæ‹‰å–ï¼ˆä¸‹è½½ï¼‰é•œåƒï¼Œæ¥ä¸‹æ¥çœ‹çœ‹æ„å»ºé•œåƒçš„ä¸¤ç§æ–¹å¼ï¼š</p><ol><li>ä½¿ç”¨<code>docker commit</code>å‘½ä»¤ã€‚ï¼ˆä¸æ¨èï¼‰</li><li>ä½¿ç”¨<code>docker build</code>å‘½ä»¤å’ŒDockerfileæ–‡ä»¶ã€‚</li></ol><h4 id=ä½¿ç”¨commitå‘½ä»¤æ„å»ºé•œåƒ><a href=#ä½¿ç”¨commitå‘½ä»¤æ„å»ºé•œåƒ class=anchor-link>#</a>ä½¿ç”¨commitå‘½ä»¤æ„å»ºé•œåƒ</h4><p>ä¸ºäº†æ¼”ç¤ºå¦‚ä½•æ„å»ºé•œåƒï¼Œæˆ‘ä»¬å…ˆä½¿ç”¨Ubuntué•œåƒæ¥å®šåˆ¶ä¸€ä¸ªå®¹å™¨ï¼Œå‘½ä»¤å¦‚ä¸‹æ‰€ç¤ºã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>docker run --name myubuntu -it ubuntu /bin/bash
</code></pre></td></tr></table></div></div></div><p>åœ¨å®¹å™¨ä¸­æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤æ¥å®‰è£…ApacheæœåŠ¡å™¨å¹¶é€€å‡ºå®¹å™¨ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>apt -y upgrade
apt -y install apache2
<span class=nb>exit</span>
</code></pre></td></tr></table></div></div></div><p>æˆ‘ä»¬å°†è¿™ä¸ªå®¹å™¨ä½œä¸ºä¸€ä¸ªå®šåˆ¶çš„WebæœåŠ¡å™¨ä¿å­˜èµ·æ¥ï¼Œå½“éœ€è¦è¿™æ ·ä¸€å°WebæœåŠ¡å™¨çš„æ—¶å€™ï¼Œå°±æ²¡æœ‰å¿…è¦é‡æ–°åˆ›å»ºå®¹å™¨å¹¶å®‰è£…Apacheäº†ã€‚</p><p>é¦–å…ˆæˆ‘ä»¬é€šè¿‡ä¸‹é¢çš„å‘½ä»¤æŸ¥çœ‹å®¹å™¨çš„IDã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>docker container ls -a
</code></pre></td></tr></table></div></div></div><pre tabindex=0><code>docker container ls -a
CONTAINER ID    IMAGE    COMMAND        CREATED        STATUS        PORTS    NAMES
014bdb321612    ubuntu   &quot;/bin/bash&quot;    5 minutes ago  Exited (0)             myubuntu
</code></pre><p>æäº¤å®šåˆ¶çš„å®¹å™¨ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>docker commit 014bdb321612 jackfrued/mywebserver
</code></pre></td></tr></table></div></div></div><p>æŸ¥çœ‹é•œåƒæ–‡ä»¶ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>docker images
</code></pre></td></tr></table></div></div></div><pre tabindex=0><code>REPOSITORY              TAG       IMAGE ID        CREATED             SIZE
jackfrued/mywebserver   latest    795b294d265a    14 seconds ago      189 MB
</code></pre><p>ç”Ÿæˆé•œåƒæ–‡ä»¶ä»¥åï¼Œåé¢å°±å¯ä»¥åˆ©ç”¨åˆšæ‰åˆ›å»ºçš„é•œåƒæ–‡ä»¶æ¥åˆ›å»ºæ–°çš„å®¹å™¨ã€‚</p><h4 id=ä½¿ç”¨dockerfileæ„å»ºé•œåƒ><a href=#ä½¿ç”¨dockerfileæ„å»ºé•œåƒ class=anchor-link>#</a>ä½¿ç”¨Dockerfileæ„å»ºé•œåƒ</h4><p>Dockerfileä½¿ç”¨DSLï¼ˆDomain Specific Languageï¼‰æ¥æ„å»ºä¸€ä¸ªDockeré•œåƒï¼Œåªè¦ç¼–è¾‘å¥½äº†Dockerfileæ–‡ä»¶ï¼Œå°±å¯ä»¥ä½¿ç”¨<code>docker build</code>å‘½ä»¤æ¥æ„å»ºä¸€ä¸ªæ–°çš„é•œåƒã€‚</p><p>æˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ªåä¸ºmyappçš„æ–‡ä»¶å¤¹æ¥ä¿å­˜é¡¹ç›®ä»£ç å’ŒDockerfileçš„æ–‡ä»¶ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell><span class=o>[</span>ECS-root temp<span class=o>]</span><span class=c1># tree myapp</span>
myapp
â”œâ”€â”€ api
â”‚   â”œâ”€â”€ app.py
â”‚   â”œâ”€â”€ requirements.txt
â”‚   â””â”€â”€ start.sh
â””â”€â”€ Dockerfile
</code></pre></td></tr></table></div></div></div><p>å…¶ä¸­apiæ˜¯Flaské¡¹ç›®çš„æ–‡ä»¶å¤¹ï¼Œå…¶ä¸­åŒ…æ‹¬äº†é¡¹ç›®ä»£ç ã€ä¾èµ–é¡¹ä»¥åŠå¯åŠ¨è„šæœ¬ç­‰æ–‡ä»¶ï¼Œå…·ä½“å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><code>app.py</code>æ–‡ä»¶ï¼š</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span>
<span class=kn>from</span> <span class=nn>flask_restful</span> <span class=kn>import</span> <span class=n>Resource</span><span class=p>,</span> <span class=n>Api</span>
<span class=kn>from</span> <span class=nn>flask_cors</span> <span class=kn>import</span> <span class=n>CORS</span>

<span class=n>app</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
<span class=n>CORS</span><span class=p>(</span><span class=n>app</span><span class=p>,</span> <span class=n>resources</span><span class=o>=</span><span class=p>{</span><span class=sa>r</span><span class=s1>&#39;/api/*&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;origins&#39;</span><span class=p>:</span> <span class=s1>&#39;*&#39;</span><span class=p>}})</span>
<span class=n>api</span> <span class=o>=</span> <span class=n>Api</span><span class=p>(</span><span class=n>app</span><span class=p>)</span>


<span class=k>class</span> <span class=nc>Product</span><span class=p>(</span><span class=n>Resource</span><span class=p>):</span>

    <span class=k>def</span> <span class=nf>get</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=n>products</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;Ice Cream&#39;</span><span class=p>,</span> <span class=s1>&#39;Chocolate&#39;</span><span class=p>,</span> <span class=s1>&#39;Coca Cola&#39;</span><span class=p>,</span> <span class=s1>&#39;Hamburger&#39;</span><span class=p>]</span>
        <span class=k>return</span> <span class=p>{</span><span class=s1>&#39;products&#39;</span><span class=p>:</span> <span class=n>products</span><span class=p>}</span>


<span class=n>api</span><span class=o>.</span><span class=n>add_resource</span><span class=p>(</span><span class=n>Product</span><span class=p>,</span> <span class=s1>&#39;/api/products&#39;</span><span class=p>)</span>
</code></pre></td></tr></table></div></div></div><p><code>requirements.txt</code>æ–‡ä»¶ï¼š</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-INI data-lang=INI><span class=na>flask</span>
<span class=na>flask-restful</span>
<span class=na>flask-cors</span>
<span class=na>gunicorn</span>
</code></pre></td></tr></table></div></div></div><p><code>start.sh</code>æ–‡ä»¶ï¼š</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell><span class=cp>#!/bin/bash
</span><span class=cp></span><span class=nb>exec</span> gunicorn -w <span class=m>4</span> -b 0.0.0.0:8000 app:app
</code></pre></td></tr></table></div></div></div><blockquote><p><strong>æç¤º</strong>ï¼šéœ€è¦ç»™start.shæ–‡ä»¶ä»¥æ‰§è¡Œæƒé™ï¼Œå¯ä»¥ä½¿ç”¨<code>chmod 755 start.sh</code>å‘½ä»¤æ¥åšåˆ°ã€‚</p></blockquote><p>Dockerfileæ–‡ä»¶ï¼š</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Dockerfile data-lang=Dockerfile><span class=c># æŒ‡å®šåŸºç¡€é•œåƒ</span><span class=err>
</span><span class=err></span><span class=k>FROM</span><span class=s> python:3.7</span><span class=err>
</span><span class=err></span><span class=c># æŒ‡å®šé•œåƒçš„ç»´æŠ¤è€…</span><span class=err>
</span><span class=err></span><span class=k>MAINTAINER</span><span class=s> jackfrued &#34;jackfrued@126.com&#34;</span><span class=err>
</span><span class=err></span><span class=c># å°†æŒ‡å®šæ–‡ä»¶æ·»åŠ åˆ°å®¹å™¨ä¸­æŒ‡å®šçš„ä½ç½®</span><span class=err>
</span><span class=err></span><span class=k>ADD</span> api/* /root/api/<span class=err>
</span><span class=err></span><span class=c># è®¾ç½®å·¥ä½œç›®å½•</span><span class=err>
</span><span class=err></span><span class=k>WORKDIR</span><span class=s> /root/api</span><span class=err>
</span><span class=err></span><span class=c># æ‰§è¡Œå‘½ä»¤(å®‰è£…Flaské¡¹ç›®çš„ä¾èµ–é¡¹)</span><span class=err>
</span><span class=err></span><span class=k>RUN</span> pip install -r requirements.txt -i https://pypi.doubanio.com/simple/<span class=err>
</span><span class=err></span><span class=c># å®¹å™¨å¯åŠ¨æ—¶è¦æ‰§è¡Œçš„å‘½ä»¤</span><span class=err>
</span><span class=err></span><span class=k>ENTRYPOINT</span> <span class=p>[</span><span class=s2>&#34;./start.sh&#34;</span><span class=p>]</span><span class=err>
</span><span class=err></span><span class=c># æš´éœ²ç«¯å£</span><span class=err>
</span><span class=err></span><span class=k>EXPOSE</span><span class=s> 8000</span><span class=err>
</span></code></pre></td></tr></table></div></div></div><p>æˆ‘ä»¬æ¥è§£é‡Šä¸€ä¸‹ä¸Šé¢çš„Dockerfileæ–‡ä»¶ã€‚Dockerfileæ–‡ä»¶é€šè¿‡ç‰¹æ®Šçš„æŒ‡ä»¤æ¥æŒ‡å®šåŸºç¡€é•œåƒï¼ˆFROMæŒ‡ä»¤ï¼‰ã€åˆ›å»ºå®¹å™¨åéœ€è¦æŒ‡å®šçš„å‘½ä»¤ï¼ˆRUNæŒ‡ä»¤ï¼‰ä»¥åŠéœ€è¦æš´éœ²çš„ç«¯å£ï¼ˆEXPOSEï¼‰ç­‰ä¿¡æ¯ã€‚æˆ‘ä»¬ç¨åä¼šä¸“é—¨ä¸ºå¤§å®¶ä»‹ç»è¿™äº›Dockfileä¸­çš„æŒ‡ä»¤ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>docker build</code>å‘½ä»¤æ¥åˆ›å»ºé•œåƒï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>docker build -t <span class=s2>&#34;jackfrued/myapp&#34;</span> .
</code></pre></td></tr></table></div></div></div><blockquote><p>æç¤ºï¼šä¸Šé¢çš„å‘½ä»¤æœ€åé¢çš„<code>.</code> åƒä¸‡ä¸è¦æ¼æ‰äº†å“¦ï¼Œå®ƒè¡¨ç¤ºä»å½“å‰è·¯å¾„ä¸‹å¯»æ‰¾Dockerfileã€‚</p></blockquote><p>é€šè¿‡ä¸‹é¢çš„å‘½ä»¤å¯ä»¥æŸ¥çœ‹åˆ›å»ºå¥½çš„é•œåƒã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>docker images
</code></pre></td></tr></table></div></div></div><pre tabindex=0><code>REPOSITORY                   TAG                 IMAGE ID            CREATED             SIZE
jackfrued/myapp              latest              6d6f026a7896        5 seconds ago       930 MB
</code></pre><p>å¦‚æœæƒ³çŸ¥é“é•œåƒæ–‡ä»¶æ˜¯å¦‚ä½•åˆ›å»ºå‡ºæ¥çš„ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>docker <span class=nb>history</span> jackfrued/myapp
</code></pre></td></tr></table></div></div></div><pre tabindex=0><code>IMAGE               CREATED             CREATED BY                                      SIZE                COMMENT
6d6f026a7896        31 seconds ago      /bin/sh -c #(nop)  EXPOSE 8000/tcp              0 B                 
3f7739173a79        31 seconds ago      /bin/sh -c #(nop)  ENTRYPOINT [&quot;./start.sh&quot;]    0 B                 
321e6bf09bf1        32 seconds ago      /bin/sh -c pip install -r requirements.txt...   13 MB               
2f9bf2c89ac7        37 seconds ago      /bin/sh -c #(nop) WORKDIR /root/api             0 B                 
86119afbe1f8        37 seconds ago      /bin/sh -c #(nop) ADD multi:4b76f9c9dfaee8...   870 B               
08d465e90d4d        3 hours ago         /bin/sh -c #(nop)  MAINTAINER jackfrued &quot;j...   0 B                 
fbf9f709ca9f        12 days ago         /bin/sh -c #(nop)  CMD [&quot;python3&quot;]              0 B 
</code></pre><p>ä½¿ç”¨è¯¥é•œåƒæ¥åˆ›å»ºå®¹å™¨è¿è¡ŒWebæœåŠ¡å™¨ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>docker run -d -p 8000:8000 --name myapp jackfrued/myapp
</code></pre></td></tr></table></div></div></div><p>å¦‚æœå¸Œæœ›å°†ä¸Šé¢åˆ›å»ºçš„é•œåƒæ–‡ä»¶æ”¾åˆ°dockerhubä»“åº“ä¸­ï¼Œå¯ä»¥æŒ‰ç…§å¦‚ä¸‹æ‰€ç¤ºçš„æ­¥éª¤è¿›è¡Œæ“ä½œã€‚</p><p>é€šè¿‡ä¸‹é¢çš„å‘½ä»¤ç™»å½•åˆ°dockerhubã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>docker login
</code></pre></td></tr></table></div></div></div><p>è¾“å…¥ç”¨æˆ·åå’Œå£ä»¤è¿›è¡Œç™»å½•ã€‚</p><pre tabindex=0><code>Login with your Docker ID to push and pull images from Docker Hub. If you don't have a Docker ID, head over to https://hub.docker.com to create one.
Username: jackfrued
Password: 
Login Succeeded
</code></pre><p>é€šè¿‡ä¸‹é¢çš„å‘½ä»¤å°†é•œåƒæ¨åˆ°ä»“åº“ä¸­ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>docker push jackfrued/webserver
</code></pre></td></tr></table></div></div></div><p><img src=/res/dockerhub-repo.png alt></p><h4 id=dockerfileæŒ‡ä»¤><a href=#dockerfileæŒ‡ä»¤ class=anchor-link>#</a>DockerfileæŒ‡ä»¤</h4><p>æƒ³äº†è§£Dockerfileçš„æŒ‡ä»¤å¯ä»¥æŸ¥çœ‹å®˜æ–¹æä¾›çš„<a href=https://docs.docker.com/engine/reference/builder/ target=_blank rel=noopener>å‚è€ƒæ‰‹å†Œ</a>ï¼Œä¸‹é¢æˆ‘ä»¬ä¸ºå¤§å®¶ä»‹ç»ä¸€äº›å¸¸ç”¨çš„æŒ‡ä»¤ã€‚</p><ol><li><p><strong>FROM</strong>ï¼šè®¾ç½®åŸºç¡€é•œåƒï¼Œå¿…é¡»æ˜¯Dockerfileä¸­çš„ç¬¬ä¸€æ¡æŒ‡ä»¤ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Dockerfile data-lang=Dockerfile><span class=k>FROM</span><span class=s> &lt;é•œåƒå&gt; [AS &lt;åˆ«å&gt;]</span><span class=err>
</span></code></pre></td></tr></table></div></div></div><p>æˆ–</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Dockerfile data-lang=Dockerfile><span class=k>FROM</span><span class=s> &lt;é•œåƒå&gt;[:&lt;æ ‡ç­¾&gt;] [AS &lt;åˆ«å&gt;]</span><span class=err>
</span></code></pre></td></tr></table></div></div></div></li><li><p><strong>RUN</strong>ï¼šæŒ‡å®šæ„å»ºé•œåƒæ—¶è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Dockerfile data-lang=Dockerfile><span class=k>RUN</span> &lt;å‘½ä»¤&gt; <span class=o>[</span>å‚æ•°1<span class=o>]</span>, <span class=o>[</span>å‚æ•°2<span class=o>]</span>, ... <span class=err>
</span></code></pre></td></tr></table></div></div></div><p>æˆ–</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Dockerfile data-lang=Dockerfile><span class=k>RUN</span> <span class=o>[</span><span class=s2>&#34;å¯æ‰§è¡Œæ–‡ä»¶&#34;</span>, <span class=s2>&#34;å‚æ•°1&#34;</span>, <span class=s2>&#34;å‚æ•°2&#34;</span>, ...<span class=o>]</span><span class=err>
</span></code></pre></td></tr></table></div></div></div></li><li><p><strong>CMD</strong>ï¼šæŒ‡å®šæ„å»ºé•œåƒåè¦æ‰§è¡Œçš„å‘½ä»¤ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Dockerfile data-lang=Dockerfile><span class=k>CMD</span> &lt;å‘½ä»¤&gt; <span class=o>[</span>å‚æ•°1<span class=o>]</span>, <span class=o>[</span>å‚æ•°2<span class=o>]</span>, ...<span class=err>
</span></code></pre></td></tr></table></div></div></div><p>æˆ–</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Dockerfile data-lang=Dockerfile><span class=k>CMD</span> <span class=p>[</span><span class=s2>&#34;å¯æ‰§è¡Œæ–‡ä»¶&#34;</span><span class=p>,</span> <span class=s2>&#34;å‚æ•°1&#34;</span><span class=p>,</span> <span class=s2>&#34;å‚æ•°2&#34;</span><span class=p>,</span> <span class=err>...</span><span class=p>]</span><span class=err>
</span></code></pre></td></tr></table></div></div></div><blockquote><p>è¯´æ˜ï¼šDockerä¸åŒäºè™šæ‹Ÿæœºï¼Œå®¹å™¨æœ¬èº«å°±æ˜¯ä¸€ä¸ªè¿›ç¨‹ï¼Œå®¹å™¨ä¸­çš„åº”ç”¨åº”è¯¥ä½äºå‰å°è¿è¡Œã€‚CMDå‘½ä»¤ç›¸å½“äºå°±æ˜¯ç”¨æ¥æŒ‡å®šå®¹å™¨ä¸»è¿›ç¨‹ï¼ˆåˆ›å»ºå®¹å™¨åè¦åœ¨å‰å°æ‰§è¡Œçš„ç¨‹åºï¼‰çš„ï¼Œå¦‚æœä¸»è¿›ç¨‹ç»“æŸäº†ï¼Œå®¹å™¨ä¹Ÿå°±åœæ­¢è¿è¡Œäº†ã€‚æ‰€ä»¥åœ¨å®¹å™¨ä¸­å¯åŠ¨Nginxä¸èƒ½ä½¿ç”¨<code>service nginx start</code>æˆ–æ˜¯<code>systemctl start nginx</code>è€Œæ˜¯è¦é€šè¿‡<code>CMD ["nginx", "-g", "daemon off;"]</code>è®©å®ƒåœ¨å‰å°è¿è¡Œã€‚</p></blockquote></li><li><p><strong>ENTRYPOINT</strong>ï¼šå’ŒCMDç±»ä¼¼ï¼Œä¹Ÿå¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œä½†<code>docker run</code>å‘½ä»¤è¡Œä¸­æŒ‡å®šçš„ä»»ä½•å‚æ•°éƒ½ä¼šè¢«å½“åšå‚æ•°å†æ¬¡ä¼ ç»™ENTRYPOINTæŒ‡ä»¤ä¸­çš„å‘½ä»¤ï¼Œè¿™å°±ä½¿å¾—æˆ‘ä»¬å¯ä»¥æ„å»ºä¸€ä¸ªé•œåƒï¼Œå®ƒæ—¢å¯ä»¥è¿è¡Œä¸€ä¸ªé»˜è®¤çš„å‘½ä»¤ï¼Œä¹Ÿæ”¯æŒé€šè¿‡<code>docker run</code>å‘½ä»¤è¡Œä¸ºè¯¥å‘½ä»¤æŒ‡å®šå¯è¦†ç›–çš„å‚æ•°é€‰é¡¹ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Dockerfile data-lang=Dockerfile><span class=k>ENTRYPOINT</span> &lt;å‘½ä»¤&gt; <span class=o>[</span>å‚æ•°1<span class=o>]</span>, <span class=o>[</span>å‚æ•°2<span class=o>]</span>, ...<span class=err>
</span></code></pre></td></tr></table></div></div></div><p>æˆ–</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Dockerfile data-lang=Dockerfile><span class=k>ENTRYPOINT</span> <span class=p>[</span><span class=s2>&#34;å¯æ‰§è¡Œæ–‡ä»¶&#34;</span><span class=p>,</span> <span class=s2>&#34;å‚æ•°1&#34;</span><span class=p>,</span> <span class=s2>&#34;å‚æ•°2&#34;</span><span class=p>,</span> <span class=err>...</span><span class=p>]</span><span class=err>
</span></code></pre></td></tr></table></div></div></div></li><li><p><strong>WORKDIR</strong>ï¼šåœ¨é€šè¿‡é•œåƒåˆ›å»ºæ–°å®¹å™¨æ—¶ï¼Œåœ¨å®¹å™¨å†…éƒ¨åˆ›å»ºä¸€ä¸ªå·¥ä½œç›®å½•ï¼ŒENTRYPOINTå’ŒCMDæŒ‡å®šçš„ç¨‹åºä¼šåœ¨è¿™ä¸ªç›®å½•ä¸‹æ‰§è¡Œã€‚åœ¨ä½¿ç”¨<code>docker run</code>å‘½ä»¤æ—¶å¯ä»¥é€šè¿‡<code>-w</code>å‚æ•°æ¥è¦†ç›–ç”±WORKDIRæŒ‡å®šçš„å·¥ä½œç›®å½•ã€‚ä¾‹å¦‚ï¼š</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Dockerfile data-lang=Dockerfile><span class=k>WORKDIR</span><span class=s> /opt/webapp</span><span class=err>
</span></code></pre></td></tr></table></div></div></div><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>docker run -w /usr/share/webapp ...
</code></pre></td></tr></table></div></div></div></li><li><p><strong>ENV</strong>ï¼šåœ¨åˆ›å»ºé•œåƒæ—¶è®¾ç½®ç¯å¢ƒå˜é‡ã€‚åœ¨ä½¿ç”¨<code>docker run</code>å‘½ä»¤æ—¶ï¼Œå¯ä»¥é€šè¿‡<code>-e</code>å‚æ•°æ¥ä¿®æ”¹ç¯å¢ƒå˜é‡çš„è®¾ç½®ã€‚ä¾‹å¦‚ï¼š</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Dockerfile data-lang=Dockerfile><span class=k>ENV</span> <span class=nv>DEFAULT_PORT</span><span class=o>=</span><span class=m>8080</span>
</code></pre></td></tr></table></div></div></div><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>docker run -e <span class=s2>&#34;DEFAULT_PORT=8000&#34;</span> ...
</code></pre></td></tr></table></div></div></div></li><li><p><strong>USER</strong>ï¼šæŒ‡å®šé•œåƒä¼šä»¥ä»€ä¹ˆç”¨æˆ·èº«ä»½å»è¿è¡Œã€‚ä¾‹å¦‚ï¼š</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Dockerfile data-lang=Dockerfile><span class=k>USER</span><span class=s> nginx</span><span class=err>
</span></code></pre></td></tr></table></div></div></div></li><li><p><strong>VOLUME</strong>ï¼šåœ¨åˆ›å»ºå®¹å™¨æ—¶æ·»åŠ ä¸€ä¸ªæ•°æ®å·çš„æŒ‚è½½ç‚¹ã€‚é€šè¿‡æ•°æ®å·æ“ä½œå¯ä»¥å®ç°å®¹å™¨é—´æ•°æ®çš„å…±äº«å’Œé‡ç”¨ï¼Œå¯¹å·æ‰€ä½œçš„ä¿®æ”¹å¯ä»¥é©¬ä¸Šç”Ÿæ•ˆè€Œä¸éœ€è¦é‡æ–°å¯åŠ¨å®¹å™¨ï¼Œæˆ‘ä»¬ä¹‹å‰åˆ›å»ºå®¹å™¨æ—¶ä½¿ç”¨<code>--volume</code>å‚æ•°å°±æ˜¯ä¸ºäº†å®ç°æ•°æ®å·çš„æ˜ å°„æ“ä½œã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Dockerfile data-lang=Dockerfile><span class=k>VOLUME</span> <span class=p>[</span><span class=s2>&#34;/è·¯å¾„1&#34;</span><span class=p>,</span> <span class=s2>&#34;/è·¯å¾„2/å­è·¯å¾„2.1/&#34;</span><span class=p>,</span> <span class=err>...</span><span class=p>]</span><span class=err>
</span></code></pre></td></tr></table></div></div></div></li><li><p><strong>ADD</strong>ï¼šå°†æ„å»ºç›®å½•ä¸‹çš„æ–‡ä»¶å’Œæ–‡ä»¶å¤¹å¤åˆ¶åˆ°é•œåƒä¸­ï¼Œå¦‚æœæ˜¯å‹ç¼©æ–‡ä»¶å’Œå½’æ¡£æ–‡ä»¶ï¼ŒADDå‘½ä»¤ä¼šå¯¹è¿™äº›æ–‡ä»¶è¿›è¡Œè§£å‹ç¼©è§£å½’æ¡£çš„æ“ä½œã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Dockerfile data-lang=Dockerfile><span class=k>ADD</span> <span class=o>[</span>--chown<span class=o>=</span>&lt;ç”¨æˆ·&gt;:&lt;ç”¨æˆ·ç»„&gt;<span class=o>]</span> &lt;æºæ–‡ä»¶&gt; &lt;ç›®æ ‡æ–‡ä»¶&gt;<span class=err>
</span></code></pre></td></tr></table></div></div></div></li><li><p><strong>COPY</strong>ï¼šéå¸¸ç±»ä¼¼äºADDï¼Œä½†ä¸ä¼šä¸»åŠ¨å¯¹æ–‡ä»¶è¿›è¡Œæå–æ“ä½œã€‚</p></li><li><p><strong>LABEL</strong>ï¼šä¸ºDockeré•œåƒæ·»åŠ ä¸€äº›å…ƒæ•°æ®ï¼Œåœ¨ä½¿ç”¨<code>docker inspect</code>å‘½ä»¤æ—¶ä¼šçœ‹åˆ°è¿™äº›å…ƒæ•°æ®ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Dockerfile data-lang=Dockerfile><span class=k>LABEL</span> <span class=nv>version</span><span class=o>=</span><span class=s2>&#34;1.0.0&#34;</span> <span class=nv>location</span><span class=o>=</span><span class=s2>&#34;Chengdu&#34;</span><span class=err>
</span></code></pre></td></tr></table></div></div></div></li><li><p><strong>ONBUILD</strong>ï¼šä¸ºé•œåƒæ·»åŠ è§¦å‘å™¨ï¼Œå½“ä¸€ä¸ªé•œåƒè¢«ç”¨ä½œå…¶ä»–é•œåƒçš„åŸºç¡€é•œåƒï¼Œè§¦å‘å™¨å°†ä¼šè¢«æ‰§è¡Œã€‚ä¾‹å¦‚ï¼š</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Dockerfile data-lang=Dockerfile><span class=k>ONBUILD</span> <span class=k>ADD</span> . /app/src<span class=err>
</span><span class=err></span><span class=k>ONBUILD</span> <span class=k>RUN</span> <span class=nb>cd</span> /app/src <span class=o>&amp;&amp;</span> make<span class=err>
</span></code></pre></td></tr></table></div></div></div></li></ol><h3 id=å¤šå®¹å™¨ç®¡ç†><a href=#å¤šå®¹å™¨ç®¡ç† class=anchor-link>#</a>å¤šå®¹å™¨ç®¡ç†</h3><p>æˆ‘ä»¬çš„é¡¹ç›®å¯èƒ½ä¼šä½¿ç”¨äº†å¤šä¸ªå®¹å™¨ï¼Œå®¹å™¨å¤šäº†ä¹‹åç®¡ç†å®¹å™¨çš„å·¥ä½œå°±ä¼šå˜å¾—éº»çƒ¦ã€‚å¦‚æœè¦å¯¹å¤šä¸ªå®¹å™¨è¿›è¡Œè‡ªåŠ¨é…ç½®ä½¿å¾—å®¹å™¨å¯ä»¥ç›¸äº’åä½œç”šè‡³å®ç°å¤æ‚çš„è°ƒåº¦ï¼Œè¿™å°±éœ€è¦è¿›è¡Œå®¹å™¨ç¼–æ’ã€‚DockeråŸç”Ÿå¯¹å®¹å™¨ç¼–æ’çš„æ”¯æŒéå¸¸å¼±ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡ç¤¾åŒºæä¾›çš„å·¥å…·æ¥å®ç°å®¹å™¨ç¼–æ’ã€‚</p><h4 id=docker-compose><a href=#docker-compose class=anchor-link>#</a>Docker Compose</h4><p>å¯ä»¥é€šè¿‡å®‰è£…Docker Composeå·¥å…·æ¥å®ç°åŸºäºYAMLæ–‡ä»¶çš„å®¹å™¨ç¼–æ’ï¼ŒYAMLæ–‡ä»¶ä¼šå®šä¹‰ä¸€ç³»åˆ—çš„å®¹å™¨ä»¥åŠå®¹å™¨è¿è¡Œæ—¶çš„å±æ€§ï¼ŒDocker Composeä¼šæ ¹æ®è¿™äº›é…ç½®æ¥ç®¡ç†å®¹å™¨ã€‚</p><ol><li><p>å®‰è£…Docker Composeã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>curl -L <span class=s2>&#34;https://github.com/docker/compose/releases/download/1.25.4/docker-compose-</span><span class=k>$(</span>uname -s<span class=k>)</span><span class=s2>-</span><span class=k>$(</span>uname -m<span class=k>)</span><span class=s2>&#34;</span> -o /usr/local/bin/docker-compose
chmod +x /usr/local/bin/docker-compose
</code></pre></td></tr></table></div></div></div><blockquote><p>è¯´æ˜ï¼šå¦‚æœæ²¡æœ‰curlå·¥å…·ï¼Œåœ¨CentOSä¸‹å¯ä»¥å…ˆé€šè¿‡åŒ…ç®¡ç†å·¥å…·yumå®‰è£…curlå†æ‰§è¡Œä¸Šé¢çš„å‘½ä»¤ã€‚</p></blockquote><p>å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨Pythonçš„åŒ…ç®¡ç†å·¥å…·pipæ¥å®‰è£…Docker Composeï¼Œå‘½ä»¤å¦‚ä¸‹æ‰€ç¤ºã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>pip3 install -U docker-compose
</code></pre></td></tr></table></div></div></div></li><li><p>ä½¿ç”¨Docker Composeã€‚</p><p>æˆ‘ä»¬åœ¨åˆšæ‰çš„Flaské¡¹ç›®ä¸­å¼•å…¥ç¼“å­˜ï¼Œç„¶åå†åˆ©ç”¨Flaskæä¾›çš„æ•°æ®æ¥å£ä¸ºå‰ç«¯é¡µé¢æä¾›æ•°æ®ï¼Œä½¿ç”¨Vue.jsè¿›è¡Œé¡µé¢æ¸²æŸ“å¹¶å°†é™æ€é¡µé¢éƒ¨ç½²åœ¨NginxæœåŠ¡å™¨ä¸Šã€‚é¡¹ç›®æ–‡ä»¶å¤¹ç»“æ„å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell><span class=o>[</span>ECS-root ~<span class=o>]</span><span class=c1># tree temp</span>
temp
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ html
â”‚   â””â”€â”€ index.html
â””â”€â”€ myapp
    â”œâ”€â”€ api
    â”‚   â”œâ”€â”€ app.py
    â”‚   â”œâ”€â”€ requirements.txt
    â”‚   â””â”€â”€ start.sh
    â””â”€â”€ Dockerfile
</code></pre></td></tr></table></div></div></div><p>ä¿®æ”¹åçš„app.pyæ–‡ä»¶ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Python data-lang=Python><span class=kn>from</span> <span class=nn>pickle</span> <span class=kn>import</span> <span class=n>dumps</span><span class=p>,</span> <span class=n>loads</span>

<span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span>
<span class=kn>from</span> <span class=nn>flask_restful</span> <span class=kn>import</span> <span class=n>Resource</span><span class=p>,</span> <span class=n>Api</span>
<span class=kn>from</span> <span class=nn>flask_cors</span> <span class=kn>import</span> <span class=n>CORS</span>
<span class=kn>from</span> <span class=nn>redis</span> <span class=kn>import</span> <span class=n>Redis</span>

<span class=n>app</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
<span class=n>CORS</span><span class=p>(</span><span class=n>app</span><span class=p>,</span> <span class=n>resources</span><span class=o>=</span><span class=p>{</span><span class=sa>r</span><span class=s1>&#39;/api/*&#39;</span><span class=p>:</span> <span class=p>{</span><span class=s1>&#39;origins&#39;</span><span class=p>:</span> <span class=s1>&#39;*&#39;</span><span class=p>}})</span>
<span class=n>api</span> <span class=o>=</span> <span class=n>Api</span><span class=p>(</span><span class=n>app</span><span class=p>)</span>
<span class=n>redis</span> <span class=o>=</span> <span class=n>Redis</span><span class=p>(</span><span class=n>host</span><span class=o>=</span><span class=s1>&#39;redis-master&#39;</span><span class=p>,</span> <span class=n>port</span><span class=o>=</span><span class=mi>6379</span><span class=p>)</span>


<span class=k>class</span> <span class=nc>Product</span><span class=p>(</span><span class=n>Resource</span><span class=p>):</span>

    <span class=k>def</span> <span class=nf>get</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
        <span class=n>data</span> <span class=o>=</span> <span class=n>redis</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;products&#39;</span><span class=p>)</span>
        <span class=k>if</span> <span class=n>data</span><span class=p>:</span>
            <span class=n>products</span> <span class=o>=</span> <span class=n>loads</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>products</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;Ice Cream&#39;</span><span class=p>,</span> <span class=s1>&#39;Chocolate&#39;</span><span class=p>,</span> <span class=s1>&#39;Coca Cola&#39;</span><span class=p>,</span> <span class=s1>&#39;Hamburger&#39;</span><span class=p>]</span>
            <span class=n>redis</span><span class=o>.</span><span class=n>set</span><span class=p>(</span><span class=s1>&#39;products&#39;</span><span class=p>,</span> <span class=n>dumps</span><span class=p>(</span><span class=n>products</span><span class=p>))</span>
        <span class=k>return</span> <span class=p>{</span><span class=s1>&#39;products&#39;</span><span class=p>:</span> <span class=n>products</span><span class=p>}</span>


<span class=n>api</span><span class=o>.</span><span class=n>add_resource</span><span class=p>(</span><span class=n>Product</span><span class=p>,</span> <span class=s1>&#39;/api/products&#39;</span><span class=p>)</span>
</code></pre></td></tr></table></div></div></div><p>htmlæ–‡ä»¶å¤¹ç”¨æ¥ä¿å­˜é™æ€é¡µé¢ï¼Œç¨åæˆ‘ä»¬ä¼šé€šä¸€ä¸ªè¿è¡ŒNginxçš„å®¹å™¨æ¥å‘æµè§ˆå™¨æä¾›é™æ€é¡µé¢ã€‚index.htmlæ–‡ä»¶çš„å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-HTML data-lang=HTML><span class=cp>&lt;!DOCTYPE html&gt;</span>
<span class=p>&lt;</span><span class=nt>html</span> <span class=na>lang</span><span class=o>=</span><span class=s>&#34;en&#34;</span><span class=p>&gt;</span>
<span class=p>&lt;</span><span class=nt>head</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>meta</span> <span class=na>charset</span><span class=o>=</span><span class=s>&#34;utf-8&#34;</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>title</span><span class=p>&gt;</span>é¦–é¡µ<span class=p>&lt;/</span><span class=nt>title</span><span class=p>&gt;</span>
<span class=p>&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>
<span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>div</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;app&#34;</span><span class=p>&gt;</span>
        <span class=p>&lt;</span><span class=nt>h2</span><span class=p>&gt;</span>äº§å“åˆ—è¡¨<span class=p>&lt;/</span><span class=nt>h2</span><span class=p>&gt;</span>
        <span class=p>&lt;</span><span class=nt>ul</span><span class=p>&gt;</span>
            <span class=p>&lt;</span><span class=nt>li</span> <span class=na>v-for</span><span class=o>=</span><span class=s>&#34;product in products&#34;</span><span class=p>&gt;</span>{{ product }}<span class=p>&lt;/</span><span class=nt>li</span><span class=p>&gt;</span>
        <span class=p>&lt;/</span><span class=nt>ul</span><span class=p>&gt;</span>
    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;https://cdn.bootcss.com/vue/2.6.10/vue.min.js&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
        <span class=k>new</span> <span class=nx>Vue</span><span class=p>({</span>
            <span class=nx>el</span><span class=o>:</span> <span class=s1>&#39;#app&#39;</span><span class=p>,</span> 
            <span class=nx>data</span><span class=o>:</span> <span class=p>{</span>
                <span class=nx>products</span><span class=o>:</span> <span class=p>[]</span>
            <span class=p>},</span>
            <span class=nx>created</span><span class=p>()</span> <span class=p>{</span>
                <span class=nx>fetch</span><span class=p>(</span><span class=s1>&#39;http://1.2.3.4:8000/api/products&#39;</span><span class=p>)</span>
                    <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>resp</span> <span class=p>=&gt;</span> <span class=nx>resp</span><span class=p>.</span><span class=nx>json</span><span class=p>())</span>
                    <span class=p>.</span><span class=nx>then</span><span class=p>(</span><span class=nx>json</span> <span class=p>=&gt;</span> <span class=p>{</span><span class=k>this</span><span class=p>.</span><span class=nx>products</span> <span class=o>=</span> <span class=nx>json</span><span class=p>.</span><span class=nx>products</span><span class=p>})</span>
            <span class=p>}</span>
        <span class=p>})</span>
    <span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
<span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
<span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</code></pre></td></tr></table></div></div></div><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¦é€šè¿‡docker-compose.ymlæ–‡ä»¶æ¥åˆ›å»ºä¸‰ä¸ªå®¹å™¨å¹¶æŒ‡æ˜å®¹å™¨ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-YAML data-lang=YAML><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;3&#39;</span><span class=w>
</span><span class=w></span><span class=nt>services</span><span class=p>:</span><span class=w>
</span><span class=w>  </span><span class=nt>api-server</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>build</span><span class=p>:</span><span class=w> </span><span class=l>./myapp</span><span class=w>
</span><span class=w>    </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span><span class=w>      </span>- <span class=s1>&#39;8000:8000&#39;</span><span class=w>
</span><span class=w>    </span><span class=nt>links</span><span class=p>:</span><span class=w>
</span><span class=w>      </span>- <span class=l>redis-master</span><span class=w>
</span><span class=w>  </span><span class=nt>web-server</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>nginx</span><span class=w>
</span><span class=w>    </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span><span class=w>      </span>- <span class=s1>&#39;80:80&#39;</span><span class=w>
</span><span class=w>    </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span><span class=w>      </span>- <span class=l>./html:/usr/share/nginx/html</span><span class=w>
</span><span class=w>  </span><span class=nt>redis-master</span><span class=p>:</span><span class=w>
</span><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>redis</span><span class=w>
</span><span class=w>    </span><span class=nt>expose</span><span class=p>:</span><span class=w>
</span><span class=w>      </span>- <span class=s1>&#39;6379&#39;</span><span class=w>
</span></code></pre></td></tr></table></div></div></div><p>æœ‰äº†è¿™ä¸ªYAMLæ–‡ä»¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨<code>docker-compose</code>å‘½ä»¤æ¥åˆ›å»ºå®¹å™¨è¿è¡Œé¡¹ç›®ï¼Œå…¶å‘½ä»¤å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell><span class=o>[</span>ECS-root temp<span class=o>]</span><span class=c1># docker-compose up</span>
Creating network <span class=s2>&#34;temp_default&#34;</span> with the default driver
Creating temp_web-server_1   ... <span class=k>done</span>
Creating temp_redis-master_1 ... <span class=k>done</span>
Creating temp_api-server_1   ... <span class=k>done</span>
Attaching to temp_redis-master_1, temp_web-server_1, temp_api-server_1
redis-master_1  <span class=p>|</span> 1:C <span class=m>05</span> Dec <span class=m>2019</span> 11:57:26.828 <span class=c1># oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo</span>
redis-master_1  <span class=p>|</span> 1:C <span class=m>05</span> Dec <span class=m>2019</span> 11:57:26.828 <span class=c1># Redis version=5.0.6, bits=64, commit=00000000, modified=0, pid=1, just started</span>
redis-master_1  <span class=p>|</span> 1:C <span class=m>05</span> Dec <span class=m>2019</span> 11:57:26.828 <span class=c1># Warning: no config file specified, using the default config. In order to specify a config file use redis-server /path/to/redis.conf</span>
redis-master_1  <span class=p>|</span> 1:M <span class=m>05</span> Dec <span class=m>2019</span> 11:57:26.830 * Running <span class=nv>mode</span><span class=o>=</span>standalone, <span class=nv>port</span><span class=o>=</span>6379.
redis-master_1  <span class=p>|</span> 1:M <span class=m>05</span> Dec <span class=m>2019</span> 11:57:26.831 <span class=c1># WARNING: The TCP backlog setting of 511 cannot be enforced because /proc/sys/net/core/somaxconn is set to the lower value of 128.</span>
redis-master_1  <span class=p>|</span> 1:M <span class=m>05</span> Dec <span class=m>2019</span> 11:57:26.831 <span class=c1># Server initialized</span>
redis-master_1  <span class=p>|</span> 1:M <span class=m>05</span> Dec <span class=m>2019</span> 11:57:26.831 <span class=c1># WARNING overcommit_memory is set to 0! Background save may fail under low memory condition. To fix this issue add &#39;vm.overcommit_memory = 1&#39; to /etc/sysctl.conf and then reboot or run the command &#39;sysctl vm.overcommit_memory=1&#39; for this to take effect.</span>
redis-master_1  <span class=p>|</span> 1:M <span class=m>05</span> Dec <span class=m>2019</span> 11:57:26.831 <span class=c1># WARNING you have Transparent Huge Pages (THP) support enabled in your kernel. This will create latency and memory usage issues with Redis. To fix this issue run the command &#39;echo never &gt; /sys/kernel/mm/transparent_hugepage/enabled&#39; as root, and add it to your /etc/rc.local in order to retain the setting after a reboot. Redis must be restarted after THP is disabled.</span>
redis-master_1  <span class=p>|</span> 1:M <span class=m>05</span> Dec <span class=m>2019</span> 11:57:26.831 * Ready to accept connections
api-server_1    <span class=p>|</span> <span class=o>[</span>2019-12-05 11:57:27 +0000<span class=o>]</span> <span class=o>[</span>1<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> Starting gunicorn 20.0.4
api-server_1    <span class=p>|</span> <span class=o>[</span>2019-12-05 11:57:27 +0000<span class=o>]</span> <span class=o>[</span>1<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> Listening at: http://0.0.0.0:8000 <span class=o>(</span>1<span class=o>)</span>
api-server_1    <span class=p>|</span> <span class=o>[</span>2019-12-05 11:57:27 +0000<span class=o>]</span> <span class=o>[</span>1<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> Using worker: sync
api-server_1    <span class=p>|</span> <span class=o>[</span>2019-12-05 11:57:27 +0000<span class=o>]</span> <span class=o>[</span>8<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> Booting worker with pid: <span class=m>8</span>
api-server_1    <span class=p>|</span> <span class=o>[</span>2019-12-05 11:57:27 +0000<span class=o>]</span> <span class=o>[</span>9<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> Booting worker with pid: <span class=m>9</span>
api-server_1    <span class=p>|</span> <span class=o>[</span>2019-12-05 11:57:27 +0000<span class=o>]</span> <span class=o>[</span>10<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> Booting worker with pid: <span class=m>10</span>
api-server_1    <span class=p>|</span> <span class=o>[</span>2019-12-05 11:57:27 +0000<span class=o>]</span> <span class=o>[</span>11<span class=o>]</span> <span class=o>[</span>INFO<span class=o>]</span> Booting worker with pid: <span class=m>11</span>
</code></pre></td></tr></table></div></div></div><p>è¦åœæ­¢å®¹å™¨çš„è¿è¡Œï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ã€‚</p><div class=highlight><div class=chroma><div class=table-container><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-Shell data-lang=Shell>docker-compose down
</code></pre></td></tr></table></div></div></div></li></ol><h4 id=kubernetesk8s><a href=#kubernetesk8s class=anchor-link>#</a>Kubernetesï¼ˆK8Sï¼‰</h4><p>å®é™…çš„ç”Ÿäº§ç¯å¢ƒä¸­å¸¸å¸¸éœ€è¦éƒ¨ç½²å’Œç®¡ç†å¤šä¸ªååŒå·¥ä½œçš„å®¹å™¨ï¼Œdocker composeè§£å†³äº†å¤šå®¹å™¨åˆ›å»ºå’Œç®¡ç†çš„é—®é¢˜ï¼Œä½†æ˜¯å®é™…é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬è¿˜éœ€è¦Kubernetesï¼ˆä»¥ä¸‹éƒ½ç®€ç§°ä¸ºK8Sï¼‰æ¥æä¾›ä¸€ä¸ªè·¨ä¸»æœºé›†ç¾¤çš„å®¹å™¨è°ƒåº¦å¹³å°ã€‚K8Så¯ä»¥è¿›è¡Œè‡ªåŠ¨åŒ–å®¹å™¨çš„éƒ¨ç½²ã€æ‰©å±•å’Œæ“ä½œï¼Œä»è€Œæä¾›ä»¥å®¹å™¨ä¸ºä¸­å¿ƒçš„åŸºç¡€æ¶æ„ã€‚è¯¥é¡¹ç›®æ˜¯è°·æ­Œåœ¨2014å¹´å¯åŠ¨çš„é¡¹ç›®ï¼Œå»ºç«‹åœ¨è°·æ­Œå…¬å¸åä½™å¹´è¿ç»´ç»éªŒçš„åŸºç¡€ä¹‹ä¸Šï¼Œè€Œä¸”è°·æ­Œè‡ªå·±çš„åº”ç”¨ä¹Ÿæ˜¯è¿è¡Œåœ¨å®¹å™¨ä¸Šçš„ã€‚</p></div><ul class=post-copyright><li class="copyright-item author"><span class=copyright-item-text>ä½œè€…</span>ï¼š<span class="p-author h-card">éª†æ˜Š</span></li><li class="copyright-item link"><span class=copyright-item-text>é“¾æ¥</span>ï¼š<a href=https://github.com/jackfrued/Python-100-Days target=_blank rel=noopener>https://github.com/jackfrued/Python-100-Days</a></li><li class="copyright-item license"><span class=copyright-item-text>è®¸å¯</span>ï¼šæœ¬æ–‡é‡‡ç”¨<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh target=_blank rel=noopener>ã€ŒCC BY-NC-SA 4.0ã€</a>åè®®ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</li></ul></article><div class=related-posts><h2 class=related-title>ç›¸å…³æ–‡ç« ï¼š<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon related-icon"><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm144 276c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6.0-12-5.4-12-12v-92h-92c-6.6.0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6.0 12 5.4 12 12v92h92c6.6.0 12 5.4 12 12v56z"/></svg></h2><ul class=related-list><li class=related-item><a href=/python/01.%E5%88%9D%E8%AF%86python/ class=related-link>01.åˆè¯†Python</a></li><li class=related-item><a href=/python/02.%E8%AF%AD%E8%A8%80%E5%85%83%E7%B4%A0/ class=related-link>02.è¯­è¨€å…ƒç´ </a></li><li class=related-item><a href=/python/03.%E5%88%86%E6%94%AF%E7%BB%93%E6%9E%84/ class=related-link>03.åˆ†æ”¯ç»“æ„</a></li><li class=related-item><a href=/python/04.%E5%BE%AA%E7%8E%AF%E7%BB%93%E6%9E%84/ class=related-link>04.å¾ªç¯ç»“æ„</a></li><li class=related-item><a href=/python/05.%E6%9E%84%E9%80%A0%E7%A8%8B%E5%BA%8F%E9%80%BB%E8%BE%91/ class=related-link>05.æ„é€ ç¨‹åºé€»è¾‘</a></li></ul></div><div class=post-tags><a href=/tags/python/ rel=tag class=post-tags-link><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon tag-icon"><path d="M0 252.118V48C0 21.49 21.49.0 48 0h204.118a48 48 0 0133.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137.0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882.0L14.059 286.059A48 48 0 010 252.118zM112 64c-26.51.0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z"/></svg>python</a></div></div></main><div id=back-to-top class=back-to-top><a href=#><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="icon arrow-up"><path d="M34.9 289.5l-22.2-22.2c-9.4-9.4-9.4-24.6.0-33.9L207 39c9.4-9.4 24.6-9.4 33.9.0l194.3 194.3c9.4 9.4 9.4 24.6.0 33.9L413 289.4c-9.5 9.5-25 9.3-34.3-.4L264 168.6V456c0 13.3-10.7 24-24 24h-32c-13.3.0-24-10.7-24-24V168.6L69.2 289.1c-9.3 9.8-24.8 10-34.3.4z"/></svg></a></div><footer id=footer class=footer><div class=footer-inner><div class=site-info>Â©&nbsp;2021â€“2022&nbsp;<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="icon footer-icon"><path d="M462.3 62.6C407.5 15.9 326 24.3 275.7 76.2L256 96.5l-19.7-20.3C186.1 24.3 104.5 15.9 49.7 62.6c-62.8 53.6-66.1 149.8-9.9 207.9l193.5 199.8c12.5 12.9 32.8 12.9 45.3.0l193.5-199.8c56.3-58.1 53-154.3-9.8-207.9z"/></svg>&nbsp;hanxin</div><script src=https://sdk.jinrishici.com/v2/browser/jinrishici.js></script>
<text class=poem_sentence></text>
<text class=poem_info></text>
<script type=text/javascript>jinrishici.load(function(a){var b=document.querySelector(".poem_sentence"),c=document.querySelector(".poem_info");b.innerHTML=a.data.content,c.innerHTML='â€”â€”'+a.data.origin.author})</script></div></footer></div><script src=https://cdn.jsdelivr.net/npm/medium-zoom@latest/dist/medium-zoom.min.js></script>
<script>mediumZoom(document.querySelectorAll('div.post-body img'),{background:'hsla(var(--color-bg-h), var(--color-bg-s), var(--color-bg-l), 0.95)'})</script><script src=https://cdn.jsdelivr.net/npm/instant.page@5.1.0/instantpage.min.js type=module defer></script></body></html>